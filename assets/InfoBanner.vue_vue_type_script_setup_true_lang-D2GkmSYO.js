import{w as K,x as m,y as u,z as ce,I as te,H as Zt,a6 as ee,E as X,F as V,M as tt,br as ht,K as mt,R as Jt,Q as ea,G as ft,S as vt,bs as ta,bt as aa,bu as ra,bv as at,bi as De,az as rt,bj as sa,T as bt,bw as oa,bx as ae,ai as J,af as ne,ba as A,aC as re,b3 as U,by as we,bf as Q,bz as Pe,bA as se,bB as st,bg as H,bC as ot,P as R,b0 as x,bD as nt,bE as pe,a$ as Z,bF as it,b1 as G,bG as na,bH as ia,bI as la,bJ as ca,b2 as da,bK as ua,a0 as de,ae as yt,a2 as D,a3 as ie,b5 as ga,ad as le,ab as He,a5 as q,a4 as j,bL as St,a9 as $e,aa as lt,a7 as ha}from"./index-CgQYXkFv.js";import{B as ma,s as fa,C as va,g as ba,D as wt,n as ya,p as Le,o as ct}from"./QInput-C7Xpa2Au.js";import{Q as Pt}from"./QImg-D8KP8f1R.js";import{a as Sa,u as wa,b as Pa,c as pa}from"./use-checkbox-BzKdm-Ud.js";import{u as Ve,a as Ne}from"./QCard-DxchUDww.js";import{g as ke,h as pt,b as At}from"./LoadingAnimation-CSeYKtkS.js";const Aa=K({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:t}){const a=te(),n=m(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return u("td",{class:n.value},ce(t.default));const r=a.vnode.key,i=(e.props.colsMap!==void 0?e.props.colsMap[r]:null)||e.props.col;if(i===void 0)return;const{row:s}=e.props;return u("td",{class:n.value+i.__tdClass(s),style:i.__tdStyle(s)},ce(t.default))}}}),ka=K({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:t,emit:a}){const n=te(),{proxy:{$q:r}}=n,i=s=>{a("click",s)};return()=>{if(e.props===void 0)return u("th",{class:e.autoWidth===!0?"q-table--col-auto-width":"",onClick:i},ce(t.default));let s,c;const d=n.vnode.key;if(d){if(s=e.props.colsMap[d],s===void 0)return}else s=e.props.col;if(s.sortable===!0){const l=s.align==="right"?"unshift":"push";c=Zt(t.default,[]),c[l](u(ee,{class:s.__iconClass,name:r.iconSet.table.arrowUp}))}else c=ce(t.default);const g={class:s.__thClass+(e.autoWidth===!0?" q-table--col-auto-width":""),style:s.headerStyle,onClick:l=>{s.sortable===!0&&e.props.sort(s),i(l)}};return u("th",g,c)}}}),Ca=["horizontal","vertical","cell","none"],Ta=K({name:"QMarkupTable",props:{...Ve,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>Ca.includes(e)}},setup(e,{slots:t}){const a=te(),n=Ne(e,a.proxy.$q),r=m(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(n.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>u("div",{class:r.value},[u("table",{class:"q-table"},ce(t.default))])}});function kt(e,t){return u("div",e,[u("table",{class:"q-table"},t)])}const _a={list:Sa,table:Ta},xa=["list","table","__qtable"],Fa=K({name:"QVirtualScroll",props:{...ma,type:{type:String,default:"list",validator:e=>xa.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:fa},setup(e,{slots:t,attrs:a}){let n;const r=X(null),i=m(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:s,localResetVirtualScroll:c,padVirtualScroll:d,onVirtualScrollEvt:g}=va({virtualScrollLength:i,getVirtualScrollTarget:k,getVirtualScrollEl:p}),l=m(()=>{if(i.value===0)return[];const B=(M,_)=>({index:s.value.from+_,item:M});return e.itemsFn===void 0?e.items.slice(s.value.from,s.value.to).map(B):e.itemsFn(s.value.from,s.value.to-s.value.from).map(B)}),f=m(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),P=m(()=>e.scrollTarget!==void 0?{}:{tabindex:0});V(i,()=>{c()}),V(()=>e.scrollTarget,()=>{S(),y()});function p(){return r.value.$el||r.value}function k(){return n}function y(){n=ba(p(),e.scrollTarget),n.addEventListener("scroll",g,tt.passive)}function S(){n!==void 0&&(n.removeEventListener("scroll",g,tt.passive),n=void 0)}function E(){let B=d(e.type==="list"?"div":"tbody",l.value.map(t.default));return t.before!==void 0&&(B=t.before().concat(B)),vt(t.after,B)}return ht(()=>{c()}),mt(()=>{y()}),Jt(()=>{y()}),ea(()=>{S()}),ft(()=>{S()}),()=>{if(t.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?kt({ref:r,class:"q-table__middle "+f.value},E()):u(_a[e.type],{...a,ref:r,class:[a.class,f.value],...P.value},E)}}}),Ia={xs:2,sm:4,md:6,lg:10,xl:14};function dt(e,t,a){return{transform:t===!0?`translateX(${a.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}const qa=K({name:"QLinearProgress",props:{...Ve,...ta,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:t}){const{proxy:a}=te(),n=Ne(e,a.$q),r=aa(e,Ia),i=m(()=>e.indeterminate===!0||e.query===!0),s=m(()=>e.reverse!==e.query),c=m(()=>({...r.value!==null?r.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),d=m(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),g=m(()=>dt(e.buffer!==void 0?e.buffer:1,s.value,a.$q)),l=m(()=>`with${e.instantFeedback===!0?"out":""}-transition`),f=m(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${l.value} q-linear-progress__track--${n.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),P=m(()=>dt(i.value===!0?1:e.value,s.value,a.$q)),p=m(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${l.value} q-linear-progress__model--${i.value===!0?"in":""}determinate`),k=m(()=>({width:`${e.value*100}%`})),y=m(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${l.value}`);return()=>{const S=[u("div",{class:f.value,style:g.value}),u("div",{class:p.value,style:P.value})];return e.stripe===!0&&i.value===!1&&S.push(u("div",{class:y.value,style:k.value})),u("div",{class:d.value,style:c.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},vt(t.default,S))}}}),Ea=()=>u("div",{key:"svg",class:"q-checkbox__bg absolute"},[u("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[u("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),u("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Ge=K({name:"QCheckbox",props:wa,emits:Pa,setup(e){const t=Ea();function a(n,r){const i=m(()=>(n.value===!0?e.checkedIcon:r.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>i.value!==null?[u("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[u(ee,{class:"q-checkbox__icon",name:i.value})])]:[t]}return pa("checkbox",a)}});let oe=0;const Ba={fullscreen:Boolean,noRouteFullscreenExit:Boolean},Ra=["update:fullscreen","fullscreen"];function Ma(){const e=te(),{props:t,emit:a,proxy:n}=e;let r,i,s;const c=X(!1);ra(e)===!0&&V(()=>n.$route.fullPath,()=>{t.noRouteFullscreenExit!==!0&&l()}),V(()=>t.fullscreen,f=>{c.value!==f&&d()}),V(c,f=>{a("update:fullscreen",f),a("fullscreen",f)});function d(){c.value===!0?l():g()}function g(){c.value!==!0&&(c.value=!0,s=n.$el.parentNode,s.replaceChild(i,n.$el),document.body.appendChild(n.$el),oe++,oe===1&&document.body.classList.add("q-body--fullscreen-mixin"),r={handler:l},at.add(r))}function l(){c.value===!0&&(r!==void 0&&(at.remove(r),r=void 0),s.replaceChild(n.$el,i),c.value=!1,oe=Math.max(0,oe-1),oe===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),n.$el.scrollIntoView!==void 0&&setTimeout(()=>{n.$el.scrollIntoView()})))}return ht(()=>{i=document.createElement("span")}),mt(()=>{t.fullscreen===!0&&g()}),ft(l),Object.assign(n,{toggleFullscreen:d,setFullscreen:g,exitFullscreen:l}),{inFullscreen:c,toggleFullscreen:d}}function Oa(e,t){return new Date(e)-new Date(t)}const Ga={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>e==="ad"||e==="da",default:"ad"}};function Da(e,t,a,n){const r=m(()=>{const{sortBy:c}=t.value;return c&&a.value.find(d=>d.name===c)||null}),i=m(()=>e.sortMethod!==void 0?e.sortMethod:(c,d,g)=>{const l=a.value.find(p=>p.name===d);if(l===void 0||l.field===void 0)return c;const f=g===!0?-1:1,P=typeof l.field=="function"?p=>l.field(p):p=>p[l.field];return c.sort((p,k)=>{let y=P(p),S=P(k);return l.rawSort!==void 0?l.rawSort(y,S,p,k)*f:y==null?-1*f:S==null?1*f:l.sort!==void 0?l.sort(y,S,p,k)*f:De(y)===!0&&De(S)===!0?(y-S)*f:rt(y)===!0&&rt(S)===!0?Oa(y,S)*f:typeof y=="boolean"&&typeof S=="boolean"?(y-S)*f:([y,S]=[y,S].map(E=>(E+"").toLocaleString().toLowerCase()),y<S?-1*f:y===S?0:f)})});function s(c){let d=e.columnSortOrder;if(sa(c)===!0)c.sortOrder&&(d=c.sortOrder),c=c.name;else{const f=a.value.find(P=>P.name===c);f!==void 0&&f.sortOrder&&(d=f.sortOrder)}let{sortBy:g,descending:l}=t.value;g!==c?(g=c,l=d==="da"):e.binaryStateSort===!0?l=!l:l===!0?d==="ad"?g=null:l=!1:d==="ad"?l=!0:g=null,n({sortBy:g,descending:l,page:1})}return{columnToSort:r,computedSortMethod:i,sort:s}}const $a={filter:[String,Object],filterMethod:Function};function La(e,t){const a=m(()=>e.filterMethod!==void 0?e.filterMethod:(n,r,i,s)=>{const c=r?r.toLowerCase():"";return n.filter(d=>i.some(g=>{const l=s(g,d)+"";return(l==="undefined"||l==="null"?"":l.toLowerCase()).indexOf(c)!==-1}))});return V(()=>e.filter,()=>{bt(()=>{t({page:1},!0)})},{deep:!0}),{computedFilterMethod:a}}function Ha(e,t){for(const a in t)if(t[a]!==e[a])return!1;return!0}function ut(e){return e.page<1&&(e.page=1),e.rowsPerPage!==void 0&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const Va={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function Na(e,t){const{props:a,emit:n}=e,r=X(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:a.rowsPerPageOptions.length!==0?a.rowsPerPageOptions[0]:5},a.pagination)),i=m(()=>{const l=a["onUpdate:pagination"]!==void 0?{...r.value,...a.pagination}:r.value;return ut(l)}),s=m(()=>i.value.rowsNumber!==void 0);function c(l){d({pagination:l,filter:a.filter})}function d(l={}){bt(()=>{n("request",{pagination:l.pagination||i.value,filter:l.filter||a.filter,getCellValue:t})})}function g(l,f){const P=ut({...i.value,...l});if(Ha(i.value,P)===!0){s.value===!0&&f===!0&&c(P);return}if(s.value===!0){c(P);return}a.pagination!==void 0&&a["onUpdate:pagination"]!==void 0?n("update:pagination",P):r.value=P}return{innerPagination:r,computedPagination:i,isServerSide:s,requestServerInteraction:d,setPagination:g}}function Ua(e,t,a,n,r,i){const{props:s,emit:c,proxy:{$q:d}}=e,g=m(()=>n.value===!0?a.value.rowsNumber||0:i.value),l=m(()=>{const{page:_,rowsPerPage:F}=a.value;return(_-1)*F}),f=m(()=>{const{page:_,rowsPerPage:F}=a.value;return _*F}),P=m(()=>a.value.page===1),p=m(()=>a.value.rowsPerPage===0?1:Math.max(1,Math.ceil(g.value/a.value.rowsPerPage))),k=m(()=>f.value===0?!0:a.value.page>=p.value),y=m(()=>(s.rowsPerPageOptions.includes(t.value.rowsPerPage)?s.rowsPerPageOptions:[t.value.rowsPerPage].concat(s.rowsPerPageOptions)).map(F=>({label:F===0?d.lang.table.allRows:""+F,value:F})));V(p,(_,F)=>{if(_===F)return;const ue=a.value.page;_&&!ue?r({page:1}):_<ue&&r({page:_})});function S(){r({page:1})}function E(){const{page:_}=a.value;_>1&&r({page:_-1})}function B(){const{page:_,rowsPerPage:F}=a.value;f.value>0&&_*F<g.value&&r({page:_+1})}function M(){r({page:p.value})}return s["onUpdate:pagination"]!==void 0&&c("update:pagination",{...a.value}),{firstRowIndex:l,lastRowIndex:f,isFirstPage:P,isLastPage:k,pagesNumber:p,computedRowsPerPageOptions:y,computedRowsNumber:g,firstPage:S,prevPage:E,nextPage:B,lastPage:M}}const ja={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},Xa=["update:selected","selection"];function Qa(e,t,a,n){const r=m(()=>{const k={};return e.selected.map(n.value).forEach(y=>{k[y]=!0}),k}),i=m(()=>e.selection!=="none"),s=m(()=>e.selection==="single"),c=m(()=>e.selection==="multiple"),d=m(()=>a.value.length!==0&&a.value.every(k=>r.value[n.value(k)]===!0)),g=m(()=>d.value!==!0&&a.value.some(k=>r.value[n.value(k)]===!0)),l=m(()=>e.selected.length);function f(k){return r.value[k]===!0}function P(){t("update:selected",[])}function p(k,y,S,E){t("selection",{rows:y,added:S,keys:k,evt:E});const B=s.value===!0?S===!0?y:[]:S===!0?e.selected.concat(y):e.selected.filter(M=>k.includes(n.value(M))===!1);t("update:selected",B)}return{hasSelectionMode:i,singleSelection:s,multipleSelection:c,allRowsSelected:d,someRowsSelected:g,rowsSelectedNumber:l,isRowSelected:f,clearSelection:P,updateSelection:p}}function gt(e){return Array.isArray(e)?e.slice():[]}const Ka={expanded:Array},za=["update:expanded"];function Wa(e,t){const a=X(gt(e.expanded));V(()=>e.expanded,s=>{a.value=gt(s)});function n(s){return a.value.includes(s)}function r(s){e.expanded!==void 0?t("update:expanded",s):a.value=s}function i(s,c){const d=a.value.slice(),g=d.indexOf(s);c===!0?g===-1&&(d.push(s),r(d)):g!==-1&&(d.splice(g,1),r(d))}return{isRowExpanded:n,setExpanded:r,updateExpanded:i}}const Ya={visibleColumns:Array};function Za(e,t,a){const n=m(()=>{if(e.columns!==void 0)return e.columns;const c=e.rows[0];return c!==void 0?Object.keys(c).map(d=>({name:d,label:d.toUpperCase(),field:d,align:De(c[d])?"right":"left",sortable:!0})):[]}),r=m(()=>{const{sortBy:c,descending:d}=t.value;return(e.visibleColumns!==void 0?n.value.filter(l=>l.required===!0||e.visibleColumns.includes(l.name)===!0):n.value).map(l=>{const f=l.align||"right",P=`text-${f}`;return{...l,align:f,__iconClass:`q-table__sort-icon q-table__sort-icon--${f}`,__thClass:P+(l.headerClasses!==void 0?" "+l.headerClasses:"")+(l.sortable===!0?" sortable":"")+(l.name===c?` sorted ${d===!0?"sort-desc":""}`:""),__tdStyle:l.style!==void 0?typeof l.style!="function"?()=>l.style:l.style:()=>null,__tdClass:l.classes!==void 0?typeof l.classes!="function"?()=>P+" "+l.classes:p=>P+" "+l.classes(p):()=>P}})}),i=m(()=>{const c={};return r.value.forEach(d=>{c[d.name]=d}),c}),s=m(()=>e.tableColspan!==void 0?e.tableColspan:r.value.length+(a.value===!0?1:0));return{colList:n,computedCols:r,computedColsMap:i,computedColspan:s}}const Ae="q-table__bottom row items-center",Ct={};wt.forEach(e=>{Ct[e]={}});const Ja=K({name:"QTable",props:{rows:{type:Array,required:!0},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{},...Ct,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...Ve,...Ba,...Ya,...$a,...Va,...Ka,...ja,...Ga},emits:["request","virtualScroll",...Ra,...za,...Xa],setup(e,{slots:t,emit:a}){const n=te(),{proxy:{$q:r}}=n,i=Ne(e,r),{inFullscreen:s,toggleFullscreen:c}=Ma(),d=m(()=>typeof e.rowKey=="function"?e.rowKey:o=>o[e.rowKey]),g=X(null),l=X(null),f=m(()=>e.grid!==!0&&e.virtualScroll===!0),P=m(()=>" q-table__card"+(i.value===!0?" q-table__card--dark q-dark":"")+(e.square===!0?" q-table--square":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")),p=m(()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(e.grid===!0?" q-table--grid":P.value)+(i.value===!0?" q-table--dark":"")+(e.dense===!0?" q-table--dense":"")+(e.wrapCells===!1?" q-table--no-wrap":"")+(s.value===!0?" fullscreen scroll":"")),k=m(()=>p.value+(e.loading===!0?" q-table--loading":""));V(()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+p.value,()=>{f.value===!0&&l.value!==null&&l.value.reset()});const{innerPagination:y,computedPagination:S,isServerSide:E,requestServerInteraction:B,setPagination:M}=Na(n,W),{computedFilterMethod:_}=La(e,M),{isRowExpanded:F,setExpanded:ue,updateExpanded:_t}=Wa(e,a),Ce=m(()=>{let o=e.rows;if(E.value===!0||o.length===0)return o;const{sortBy:h,descending:v}=S.value;return e.filter&&(o=_.value(o,e.filter,$.value,W)),Et.value!==null&&(o=Bt.value(e.rows===o?o.slice():o,h,v)),o}),Ue=m(()=>Ce.value.length),N=m(()=>{let o=Ce.value;if(E.value===!0)return o;const{rowsPerPage:h}=S.value;return h!==0&&(he.value===0&&e.rows!==o?o.length>me.value&&(o=o.slice(0,me.value)):o=o.slice(he.value,me.value)),o}),{hasSelectionMode:z,singleSelection:xt,multipleSelection:je,allRowsSelected:Ft,someRowsSelected:Xe,rowsSelectedNumber:Te,isRowSelected:_e,clearSelection:It,updateSelection:ge}=Qa(e,a,N,d),{colList:qt,computedCols:$,computedColsMap:Qe,computedColspan:Ke}=Za(e,S,z),{columnToSort:Et,computedSortMethod:Bt,sort:xe}=Da(e,S,qt,M),{firstRowIndex:he,lastRowIndex:me,isFirstPage:Fe,isLastPage:Ie,pagesNumber:fe,computedRowsPerPageOptions:Rt,computedRowsNumber:ve,firstPage:qe,prevPage:Ee,nextPage:Be,lastPage:Re}=Ua(n,y,S,E,M,Ue),Mt=m(()=>N.value.length===0),Ot=m(()=>{const o={};return wt.forEach(h=>{o[h]=e[h]}),o.virtualScrollItemSize===void 0&&(o.virtualScrollItemSize=e.dense===!0?28:48),o});function Gt(){f.value===!0&&l.value.reset()}function Dt(){if(e.grid===!0)return Wt();const o=e.hideHeader!==!0?Je:null;if(f.value===!0){const v=t["top-row"],b=t["bottom-row"],w={default:T=>We(T.item,t.body,T.index)};if(v!==void 0){const T=u("tbody",v({cols:$.value}));w.before=o===null?()=>T:()=>[o()].concat(T)}else o!==null&&(w.before=o);return b!==void 0&&(w.after=()=>u("tbody",b({cols:$.value}))),u(Fa,{ref:l,class:e.tableClass,style:e.tableStyle,...Ot.value,scrollTarget:e.virtualScrollTarget,items:N.value,type:"__qtable",tableColspan:Ke.value,onVirtualScroll:Lt},w)}const h=[Ht()];return o!==null&&h.unshift(o()),kt({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},h)}function $t(o,h){if(l.value!==null){l.value.scrollTo(o,h);return}o=parseInt(o,10);const v=g.value.querySelector(`tbody tr:nth-of-type(${o+1})`);if(v!==null){const b=g.value.querySelector(".q-table__middle.scroll"),w=v.offsetTop-e.virtualScrollStickySizeStart,T=w<b.scrollTop?"decrease":"increase";b.scrollTop=w,a("virtualScroll",{index:o,from:0,to:y.value.rowsPerPage-1,direction:T})}}function Lt(o){a("virtualScroll",o)}function ze(){return[u(qa,{class:"q-table__linear-progress",color:e.color,dark:i.value,indeterminate:!0,trackColor:"transparent"})]}function We(o,h,v){const b=d.value(o),w=_e(b);if(h!==void 0)return h(Ye({key:b,row:o,pageIndex:v,__trClass:w?"selected":""}));const T=t["body-cell"],C=$.value.map(I=>{const ye=t[`body-cell-${I.name}`],Se=ye!==void 0?ye:T;return Se!==void 0?Se(Vt({key:b,row:o,pageIndex:v,col:I})):u("td",{class:I.__tdClass(o),style:I.__tdStyle(o)},W(I,o))});if(z.value===!0){const I=t["body-selection"],ye=I!==void 0?I(Nt({key:b,row:o,pageIndex:v})):[u(Ge,{modelValue:w,color:e.color,dark:i.value,dense:e.dense,"onUpdate:modelValue":(Se,Yt)=>{ge([b],[o],Se,Yt)}})];C.unshift(u("td",{class:"q-table--col-auto-width"},ye))}const L={key:b,class:{selected:w}};return e.onRowClick!==void 0&&(L.class["cursor-pointer"]=!0,L.onClick=I=>{a("rowClick",I,o,v)}),e.onRowDblclick!==void 0&&(L.class["cursor-pointer"]=!0,L.onDblclick=I=>{a("rowDblclick",I,o,v)}),e.onRowContextmenu!==void 0&&(L.class["cursor-pointer"]=!0,L.onContextmenu=I=>{a("rowContextmenu",I,o,v)}),u("tr",L,C)}function Ht(){const o=t.body,h=t["top-row"],v=t["bottom-row"];let b=N.value.map((w,T)=>We(w,o,T));return h!==void 0&&(b=h({cols:$.value}).concat(b)),v!==void 0&&(b=b.concat(v({cols:$.value}))),u("tbody",b)}function Ye(o){return Me(o),o.cols=o.cols.map(h=>ae({...h},"value",()=>W(h,o.row))),o}function Vt(o){return Me(o),ae(o,"value",()=>W(o.col,o.row)),o}function Nt(o){return Me(o),o}function Me(o){Object.assign(o,{cols:$.value,colsMap:Qe.value,sort:xe,rowIndex:he.value+o.pageIndex,color:e.color,dark:i.value,dense:e.dense}),z.value===!0&&ae(o,"selected",()=>_e(o.key),(h,v)=>{ge([o.key],[o.row],h,v)}),ae(o,"expand",()=>F(o.key),h=>{_t(o.key,h)})}function W(o,h){const v=typeof o.field=="function"?o.field(h):h[o.field];return o.format!==void 0?o.format(v,h):v}const Y=m(()=>({pagination:S.value,pagesNumber:fe.value,isFirstPage:Fe.value,isLastPage:Ie.value,firstPage:qe,prevPage:Ee,nextPage:Be,lastPage:Re,inFullscreen:s.value,toggleFullscreen:c}));function Ut(){const o=t.top,h=t["top-left"],v=t["top-right"],b=t["top-selection"],w=z.value===!0&&b!==void 0&&Te.value>0,T="q-table__top relative-position row items-center";if(o!==void 0)return u("div",{class:T},[o(Y.value)]);let C;if(w===!0?C=b(Y.value).slice():(C=[],h!==void 0?C.push(u("div",{class:"q-table__control"},[h(Y.value)])):e.title&&C.push(u("div",{class:"q-table__control"},[u("div",{class:["q-table__title",e.titleClass]},e.title)]))),v!==void 0&&(C.push(u("div",{class:"q-table__separator col"})),C.push(u("div",{class:"q-table__control"},[v(Y.value)]))),C.length!==0)return u("div",{class:T},C)}const Ze=m(()=>Xe.value===!0?null:Ft.value);function Je(){const o=jt();return e.loading===!0&&t.loading===void 0&&o.push(u("tr",{class:"q-table__progress"},[u("th",{class:"relative-position",colspan:Ke.value},ze())])),u("thead",o)}function jt(){const o=t.header,h=t["header-cell"];if(o!==void 0)return o(Oe({header:!0})).slice();const v=$.value.map(b=>{const w=t[`header-cell-${b.name}`],T=w!==void 0?w:h,C=Oe({col:b});return T!==void 0?T(C):u(ka,{key:b.name,props:C},()=>b.label)});if(xt.value===!0&&e.grid!==!0)v.unshift(u("th",{class:"q-table--col-auto-width"}," "));else if(je.value===!0){const b=t["header-selection"],w=b!==void 0?b(Oe({})):[u(Ge,{color:e.color,modelValue:Ze.value,dark:i.value,dense:e.dense,"onUpdate:modelValue":et})];v.unshift(u("th",{class:"q-table--col-auto-width"},w))}return[u("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},v)]}function Oe(o){return Object.assign(o,{cols:$.value,sort:xe,colsMap:Qe.value,color:e.color,dark:i.value,dense:e.dense}),je.value===!0&&ae(o,"selected",()=>Ze.value,et),o}function et(o){Xe.value===!0&&(o=!1),ge(N.value.map(d.value),N.value,o)}const be=m(()=>{const o=[e.iconFirstPage||r.iconSet.table.firstPage,e.iconPrevPage||r.iconSet.table.prevPage,e.iconNextPage||r.iconSet.table.nextPage,e.iconLastPage||r.iconSet.table.lastPage];return r.lang.rtl===!0?o.reverse():o});function Xt(){if(e.hideBottom===!0)return;if(Mt.value===!0){if(e.hideNoData===!0)return;const v=e.loading===!0?e.loadingLabel||r.lang.table.loading:e.filter?e.noResultsLabel||r.lang.table.noResults:e.noDataLabel||r.lang.table.noData,b=t["no-data"],w=b!==void 0?[b({message:v,icon:r.iconSet.table.warning,filter:e.filter})]:[u(ee,{class:"q-table__bottom-nodata-icon",name:r.iconSet.table.warning}),v];return u("div",{class:Ae+" q-table__bottom--nodata"},w)}const o=t.bottom;if(o!==void 0)return u("div",{class:Ae},[o(Y.value)]);const h=e.hideSelectedBanner!==!0&&z.value===!0&&Te.value>0?[u("div",{class:"q-table__control"},[u("div",[(e.selectedRowsLabel||r.lang.table.selectedRecords)(Te.value)])])]:[];if(e.hidePagination!==!0)return u("div",{class:Ae+" justify-end"},Kt(h));if(h.length!==0)return u("div",{class:Ae},h)}function Qt(o){M({page:1,rowsPerPage:o.value})}function Kt(o){let h;const{rowsPerPage:v}=S.value,b=e.paginationLabel||r.lang.table.pagination,w=t.pagination,T=e.rowsPerPageOptions.length>1;if(o.push(u("div",{class:"q-table__separator col"})),T===!0&&o.push(u("div",{class:"q-table__control"},[u("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||r.lang.table.recordsPerPage]),u(ya,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:v,options:Rt.value,displayValue:v===0?r.lang.table.allRows:v,dark:i.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":Qt})])),w!==void 0)h=w(Y.value);else if(h=[u("span",v!==0?{class:"q-table__bottom-item"}:{},[v?b(he.value+1,Math.min(me.value,ve.value),ve.value):b(1,Ue.value,ve.value)])],v!==0&&fe.value>1){const C={color:e.color,round:!0,dense:!0,flat:!0};e.dense===!0&&(C.size="sm"),fe.value>2&&h.push(u(J,{key:"pgFirst",...C,icon:be.value[0],disable:Fe.value,onClick:qe})),h.push(u(J,{key:"pgPrev",...C,icon:be.value[1],disable:Fe.value,onClick:Ee}),u(J,{key:"pgNext",...C,icon:be.value[2],disable:Ie.value,onClick:Be})),fe.value>2&&h.push(u(J,{key:"pgLast",...C,icon:be.value[3],disable:Ie.value,onClick:Re}))}return o.push(u("div",{class:"q-table__control"},h)),o}function zt(){const o=e.gridHeader===!0?[u("table",{class:"q-table"},[Je()])]:e.loading===!0&&t.loading===void 0?ze():void 0;return u("div",{class:"q-table__middle"},o)}function Wt(){const o=t.item!==void 0?t.item:h=>{const v=h.cols.map(w=>u("div",{class:"q-table__grid-item-row"},[u("div",{class:"q-table__grid-item-title"},[w.label]),u("div",{class:"q-table__grid-item-value"},[w.value])]));if(z.value===!0){const w=t["body-selection"],T=w!==void 0?w(h):[u(Ge,{modelValue:h.selected,color:e.color,dark:i.value,dense:e.dense,"onUpdate:modelValue":(C,L)=>{ge([h.key],[h.row],C,L)}})];v.unshift(u("div",{class:"q-table__grid-item-row"},T),u(Le,{dark:i.value}))}const b={class:["q-table__grid-item-card"+P.value,e.cardClass],style:e.cardStyle};return(e.onRowClick!==void 0||e.onRowDblclick!==void 0)&&(b.class[0]+=" cursor-pointer",e.onRowClick!==void 0&&(b.onClick=w=>{a("RowClick",w,h.row,h.pageIndex)}),e.onRowDblclick!==void 0&&(b.onDblclick=w=>{a("RowDblclick",w,h.row,h.pageIndex)})),u("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(h.selected===!0?" q-table__grid-item--selected":"")},[u("div",b,v)])};return u("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},N.value.map((h,v)=>o(Ye({key:d.value(h),row:h,pageIndex:v}))))}return Object.assign(n.proxy,{requestServerInteraction:B,setPagination:M,firstPage:qe,prevPage:Ee,nextPage:Be,lastPage:Re,isRowSelected:_e,clearSelection:It,isRowExpanded:F,setExpanded:ue,sort:xe,resetVirtualScroll:Gt,scrollTo:$t,getCellValue:W}),oa(n.proxy,{filteredSortedRows:()=>Ce.value,computedRows:()=>N.value,computedRowsNumber:()=>ve.value}),()=>{const o=[Ut()],h={ref:g,class:k.value};return e.grid===!0?o.push(zt()):Object.assign(h,{class:[h.class,e.cardClass],style:e.cardStyle}),o.push(Dt(),Xt()),e.loading===!0&&t.loading!==void 0&&o.push(t.loading()),u("div",h,o)}}});async function O(e){try{return await ne().connection.getAccountInfo(e)!==null}catch{return!1}}class Tt{signer;constructor(t){this.signer=t}async depositShipToGameIx(t,a){const n=[],r=A.createAssociatedTokenAccountIdempotent(t,this.signer.publicKey(),!0),i=A.createAssociatedTokenAccountIdempotent(t,re().sageProfileAddress,!0);await O(i.address)||n.push(i.instructions);const s=this.signer,c=r.address,d=this.getShipByMint(t),g=i.address,l={shipAmount:new U(a),index:null};return n.push(we.addShipEscrow(this.getSageProgram(),this.getPlayerProfileAddress(),this.getProfileFactionAddress(),this.getSageProfileAddress(),s,c,d,g,this.getStarbasePlayerAddress(),this.getStarbaseAddress(),this.getGameId(),this.getGameState(),l)),n}async withdrawShipFromGameIx(t,a){const n=[];let r=0,i=0;for(;r<a;){const s=this.getShipEscrow(t);i=s.amount.toNumber()>a?a:s.amount.toNumber();const c=A.createAssociatedTokenAccountIdempotent(t,re().sageProfileAddress,!0),d=A.createAssociatedTokenAccountIdempotent(t,this.signer.publicKey(),!0);await O(d.address)||n.push(d.instructions);const g=d.address,l=c.address,f={shipAmount:new U(i),permissionKeyIndex:0,shipEscrowIndex:this.getShipEscrowIndex(t)};n.push(we.removeShipEscrow(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),this.getSageProfileAddress(),g,this.getShipByMint(t),l,this.getStarbasePlayerAddress(),this.getStarbaseAddress(),this.getGameId(),this.getGameState(),f)),r+=i}return n}async depositCargoToGameIx(t,a){if(!t)throw Error("mint can not be empty");if(!a||a==0)throw Error("amount can not be empty");if(!Q().currentStarbase)throw Error("no starbase selected");const n=[],r=await Pe(),i=A.createAssociatedTokenAccountIdempotent(t,this.signer.publicKey(),!0),s=A.createAssociatedTokenAccountIdempotent(t,r,!0);await O(s.address)||n.push(s.instructions);const c=this.signer,d=i.address,g=s.address,l={amount:new U(a),keyIndex:0};return n.push(se.depositCargoToGame(this.getSageProgram(),this.getCargoProgram(),this.getStarbasePlayerAddress(),c,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),this.getStarbaseAddress(),r,this.getCargoType(t),this.getCargoStatsDefinition(),d,g,this.getGameId(),this.getGameState(),l)),n}async withdrawCargoFromGameIx(t,a){if(!t)throw Error("mint can not be empty");if(!a||a==0)throw Error("amount can not be empty");if(!Q().currentStarbase)throw Error("no starbase selected");const n=[],r=await Pe(),i=A.createAssociatedTokenAccountIdempotent(t,r,!0),s=A.createAssociatedTokenAccountIdempotent(t,this.signer.publicKey(),!0);await O(s.address)||n.push(s.instructions);const c=this.signer,d=this.signer.publicKey(),g=st(this.getCargoStatsDefinition(),t),l=i.address,f=s.address,P=t,p={amount:new U(a),keyIndex:0};return n.push(se.withdrawCargoFromGame(this.getSageProgram(),this.getCargoProgram(),this.getStarbasePlayerAddress(),c,d,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),this.getStarbaseAddress(),r,g,this.getCargoStatsDefinition(),l,f,P,this.getGameId(),this.getGameState(),p)),n}async depositCrewToGameIx(t){const a=[],n=H().walletCrewAccounts?.find(l=>l.id.toString()==t),r=await ot(new R(t)),i=[{creatorHash:new R(n.compression.creator_hash),dataHash:new R(n.compression.data_hash),leafIndex:n.compression.leaf_id,merkleTree:r.merkleTree,root:r.root,proof:r.proof.slice(0,5)}],s=this.signer,c=new R("4ZaW8ecxSP13NTC9SyTTJ2s2s2jexp9cDwGuuZrphQcd"),d={items:i};return a.push(we.addCrewToGame(this.getSageProgram(),this.getPlayerProfileAddress(),this.getProfileFactionAddress(),s,this.getStarbasePlayerAddress(),this.getStarbaseAddress(),c,this.getGameId(),d,void 0)),a}async withdrawCrewFromGameIx(t){const a=[],n=Q().starbaseCrewAccounts?.find(l=>l.id.toString()==t),r=await ot(new R(t)),i=[{creatorHash:new R(n.compression.creator_hash),dataHash:new R(n.compression.data_hash),leafIndex:n.compression.leaf_id,merkleTree:r.merkleTree,root:r.root,proof:r.proof.slice(0,5)}],s=this.signer.publicKey(),c=new R("4ZaW8ecxSP13NTC9SyTTJ2s2s2jexp9cDwGuuZrphQcd"),d={items:i,keyIndex:0};return a.push(we.removeCrewFromGame(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),s,this.getStarbasePlayerAddress(),this.getStarbaseAddress(),c,this.getGameId(),d,void 0)),a}createNewFleetIx(t,a,n){if(!n.length)throw Error("Fleet name can not be empty!");const r=[],i=er(a),s=A.stringToByteArray(n,32),c={shipAmount:i[0],shipEscrowIndex:this.getShipEscrowIndex(t),fleetLabel:s,keyIndex:0},d=x.Fleet.createFleet(this.getSageProgram(),this.getCargoProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),nt(t),pe(),this.getStarbaseAddress(),this.getGameId(),this.getGameState(),this.getCargoStatsDefinition(),c);return r.push(d.instructions),r}addShipsToFleetIx(t,a,n){const r=[],i={shipAmount:n,shipEscrowIndex:this.getShipEscrowIndex(a),fleetShipInfoIndex:null,keyIndex:0};return r.push(x.Fleet.addShipToFleet(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),t,this.getShipByMint(a),pe(),this.getStarbaseAddress(),this.getGameId(),this.getGameState(),i)),r}async disbandFleetIx(t){const a=[],n=await A.readFromRPCOrError(ne().connection,Z().sageProgram.value,t,x.Fleet,"confirmed"),r=x.Fleet.disbandFleet(this.getSageProgram(),this.getCargoProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),n,pe(),this.getStarbaseAddress(),this.getGameId(),this.getGameState(),{keyIndex:0});a.push(r.instructions);const i=it.findAddress(this.getSageProgram(),t)[0];return(await A.readFromRPCOrError(ne().connection,this.getSageProgram(),i,it)).fleetShips.forEach(c=>{a.push(x.DisbandedFleet.disbandedFleetToEscrow(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),r.disbandedFleetKey[0],i,c.ship,this.getStarbasePlayerAddress(),this.getStarbaseAddress(),this.getGameId(),this.getGameState(),{fleetShipInfoIndex:0,shipAmount:c.amount.toNumber(),shipEscrowIndex:null,keyIndex:0}))}),a.push(x.DisbandedFleet.closeDisbandedFleet(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),"funder",r.disbandedFleetKey[0],i,{keyIndex:0})),a.push(se.removeCargoPod(this.getSageProgram(),this.getCargoProgram(),this.getStarbasePlayerAddress(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),"funder",this.getStarbaseAddress(),n.data.ammoBank,this.getGameId(),this.getGameState(),{keyIndex:0})),a.push(se.removeCargoPod(this.getSageProgram(),this.getCargoProgram(),this.getStarbasePlayerAddress(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),"funder",this.getStarbaseAddress(),n.data.cargoHold,this.getGameId(),this.getGameState(),{keyIndex:0})),a.push(se.removeCargoPod(this.getSageProgram(),this.getCargoProgram(),this.getStarbasePlayerAddress(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),"funder",this.getStarbaseAddress(),n.data.fuelTank,this.getGameId(),this.getGameState(),{keyIndex:0})),a}async cargoToFleetIx(t,a,n){const r=[],i=await A.readFromRPCOrError(ne().connection,Z().sageProgram.value,t,x.Fleet,"confirmed"),s=H().tokenList.find(f=>f.mint==a.toString()).symbol,c=await Pe();let d,g,l;switch(s){case"FUEL":d=i.data.fuelTank,g=A.createAssociatedTokenAccountIdempotent(a,c,!0),l=A.createAssociatedTokenAccountIdempotent(a,d,!0);break;case"AMMO":d=i.data.ammoBank,g=A.createAssociatedTokenAccountIdempotent(a,c,!0),l=A.createAssociatedTokenAccountIdempotent(a,d,!0);break;default:d=i.data.cargoHold,g=A.createAssociatedTokenAccountIdempotent(a,c,!0),l=A.createAssociatedTokenAccountIdempotent(a,d,!0);break}return console.log("cargoPodFROM",c.toString()),console.log("cargoPodTO",d.toString()),console.log("tokenFROM",g.address.toString()),console.log("tokenTO",l.address.toString()),await O(l.address)||r.push(l.instructions),r.push(x.Fleet.depositCargoToFleet(this.getSageProgram(),this.getCargoProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),"funder",this.getStarbaseAddress(),this.getStarbasePlayerAddress(),t,c,d,this.getCargoType(a),this.getCargoStatsDefinition(),g.address,l.address,a,this.getGameId(),this.getGameState(),{amount:new U(n),keyIndex:0})),r}async cargoToStarbaseIx(t,a,n){const r=[],i=await A.readFromRPCOrError(ne().connection,Z().sageProgram.value,t,x.Fleet,"confirmed"),s=H().tokenList.find(f=>f.mint==a.toString()).symbol;let c;const d=await Pe();let g,l;switch(s){case"FUEL":c=i.data.fuelTank,g=A.createAssociatedTokenAccountIdempotent(a,c,!0),l=A.createAssociatedTokenAccountIdempotent(a,d,!0);break;case"AMMO":c=i.data.ammoBank,g=A.createAssociatedTokenAccountIdempotent(a,c,!0),l=A.createAssociatedTokenAccountIdempotent(a,d,!0);break;default:c=i.data.cargoHold,g=A.createAssociatedTokenAccountIdempotent(a,c,!0),l=A.createAssociatedTokenAccountIdempotent(a,d,!0);break}return console.log("cargoPodFROM",c.toString()),console.log("cargoPodTO",d.toString()),console.log("tokenFROM",g.address.toString()),console.log("tokenTO",l.address.toString()),await O(l.address)||r.push(l.instructions),r.push(x.Fleet.withdrawCargoFromFleet(this.getSageProgram(),this.getCargoProgram(),this.signer,"funder",this.getPlayerProfileAddress(),this.getProfileFactionAddress(),this.getStarbaseAddress(),this.getStarbasePlayerAddress(),t,c,d,this.getCargoType(a),this.getCargoStatsDefinition(),g.address,l.address,a,this.getGameId(),this.getGameState(),{amount:new U(n),keyIndex:0})),r}async fleetUndock(t){const a=[];return a.push(x.Fleet.loadingBayToIdle(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),t,this.getStarbaseAddress(),this.getStarbasePlayerAddress(),this.getGameId(),this.getGameState(),0)),a}async fleetDock(t){const a=[];return a.push(x.Fleet.idleToLoadingBay(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),t,this.getStarbaseAddress(),this.getStarbasePlayerAddress(),this.getGameId(),this.getGameState(),0)),a}async startMining(t){const a=[],n=this.getPlanetAddressByFleetKey(t),r=this.getResourceByPlanetKey(n),i=r?.key,s=r?.data.mineItem;return a.push(x.Fleet.startMiningAsteroid(this.getSageProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),t,this.getStarbaseAddress(),this.getStarbasePlayerAddress(),s,i,n,this.getGameState(),this.getGameId(),this.getFuelTokenAccountByFleetKey(t),{keyIndex:0})),a}async asteroidMiningHandler(t){const a=[],n=new R("AEE2o2CH7mGqaxA5aD3yhWwCHatmYxopnNevvMTcHS9C"),r=this.getMintBySymbol("FUEL"),i=this.getMintBySymbol("FOOD"),s=this.getMintBySymbol("AMMO"),c=this.getMintBySymbol("HYG");this.getFleetByKey(t)?.data.fuelTank;const d=this.getFleetByKey(t)?.data.cargoHold,g=this.getFleetByKey(t)?.data.ammoBank;A.createAssociatedTokenAccountIdempotent(r,this.getFuelTokenAccountByFleetKey(t),!0);const l=this.getMineItemAddress(c),f=this.getResourceAddress(l,n),P=A.createAssociatedTokenAccountIdempotent(i,d,!0),p=A.createAssociatedTokenAccountIdempotent(s,g,!0),k=A.createAssociatedTokenAccountIdempotent(c,l,!0),y=A.createAssociatedTokenAccountIdempotent(c,d,!0);return await O(P.address)||a.push(P.instructions),await O(p.address)||a.push(p.instructions),await O(k.address)||a.push(k.instructions),await O(y.address)||a.push(y.instructions),a.push(x.Fleet.asteroidMiningHandler(this.getSageProgram(),this.getCargoProgram(),t,this.getStarbaseAddress(),l,f,n,d,g,this.getCargoTypeAddress(i),this.getCargoTypeAddress(s),this.getCargoTypeAddress(c),this.getCargoStatsDefinition(),this.getGameState(),this.getGameId(),P.address,p.address,k.address,y.address,i,s)),a}async stopMining(t){const a=[],n=new R("AEE2o2CH7mGqaxA5aD3yhWwCHatmYxopnNevvMTcHS9C"),r=this.getMintBySymbol("HYG"),i=this.getMintBySymbol("FUEL"),s=this.getMineItemAddress(r),c=this.getResourceAddress(s,n),d=this.getFleetByKey(t)?.data.fuelTank,g=A.createAssociatedTokenAccountIdempotent(i,d,!0);return await O(g.address)||a.push(g.instructions),[this.getSageProgram(),this.getCargoProgram(),this.getPointsProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),t,s,c,n,d,this.getCargoTypeAddress(r),this.getCargoStatsDefinition(),this.getUserPointsAccountAddress(this.getMiningXpCategory()),this.getMiningXpCategory(),this.getPointsModifierAddress(this.getMiningXpCategory()),this.getUserPointsAccountAddress(this.getPilotXpCategory()),this.getPilotXpCategory(),this.getPointsModifierAddress(this.getPilotXpCategory()),this.getUserPointsAccountAddress(this.getCouncilRankXpCategory()),this.getCouncilRankXpCategory(),this.getPointsModifierAddress(this.getCouncilRankXpCategory()),this.getGameState(),this.getGameId(),g.address,i].forEach(f=>console.log(f.toString())),a.push(x.Fleet.stopMiningAsteroid(this.getSageProgram(),this.getCargoProgram(),this.getPointsProgram(),this.signer,this.getPlayerProfileAddress(),this.getProfileFactionAddress(),t,s,c,n,d,this.getCargoTypeAddress(i),this.getCargoStatsDefinition(),this.getUserPointsAccountAddress(this.getMiningXpCategory()),this.getMiningXpCategory(),this.getPointsModifierAddress(this.getMiningXpCategory()),this.getUserPointsAccountAddress(this.getPilotXpCategory()),this.getPilotXpCategory(),this.getPointsModifierAddress(this.getPilotXpCategory()),this.getUserPointsAccountAddress(this.getCouncilRankXpCategory()),this.getCouncilRankXpCategory(),this.getPointsModifierAddress(this.getCouncilRankXpCategory()),this.getGameState(),this.getGameId(),g.address,i,{keyIndex:0})),a}getSageProgram=()=>Z()?.sageProgram.value??(()=>{throw new Error("no sageProgram set")})();getCargoProgram=()=>Z()?.cargoProgram.value??(()=>{throw new Error("no cargoProgram set")})();getPointsProgram=()=>Z()?.pointsProgram.value??(()=>{throw new Error("no pointsProgram set")})();getPlayerProfileAddress=()=>re()?.playerProfileAddress??(()=>{throw new Error("no playerProfileAddress set")})();getSageProfileAddress=()=>re()?.sageProfileAddress??(()=>{throw new Error("no sageProfileAddress set")})();getProfileFactionAddress=()=>re()?.factionProfileAddress??(()=>{throw new Error("no factionProfileAddress set")})();getStarbaseAddress=()=>Q().currentStarbase?.key??(()=>{throw new Error("no starbase set")})();getStarbasePlayerAddress=()=>pe()??(()=>{throw new Error("no starbasePlayerAddress found")})();getGameId=()=>G().gameID??(()=>{throw new Error("no gameId set")})();getGameState=()=>G().game.data.gameState??(()=>{throw new Error("no gameState set")})();getCargoType=t=>st(this.getCargoStatsDefinition(),t)??(()=>{throw new Error("no cargoStatsDefinition set")})();getShipByMint=t=>nt(t)??(()=>{throw new Error("no ship found")})();getShipEscrow=t=>Q().starbaseTokenAccounts?.filter(a=>a.itemType=="ship")?.find(a=>a.mint.toString()==t.toString())?.wrappedShipEscrows.sort((a,n)=>a.amount.toNumber()-n.amount.toNumber()).at(0)??(()=>{throw new Error("no shipEscrow found")})();getShipEscrowIndex=t=>Q().starbasePlayer?.wrappedShipEscrows.findIndex(a=>a.ship.toString()==this.getShipByMint(t)?.toString()&&a.amount==this.getShipEscrow(t)?.amount)??(()=>{throw new Error("no getShipEscrowIndex found")})();getFleetByKey=t=>Q().fleets?.find(a=>a.key.toString()==t.toString())??(()=>{throw new Error("no fleet key found")})();getPlanetAddressByFleetKey=t=>G().planets?.filter(a=>a.data.numResources>0).find(a=>a.data.sector[0]?.eq(this.getFleetByKey(t).state.Idle?.sector[0]??new U(0))&&a.data.sector[1]?.eq(this.getFleetByKey(t).state.Idle?.sector[1]??new U(0)))?.key??(()=>{throw new Error("no planet address found")})();getResourceByPlanetKey=t=>G().resources?.find(a=>a.data.location.toString()==t.toString())??(()=>{throw new Error("no resource for planet found")})();getFuelTokenAccountByFleetKey=t=>na(new R(H().tokenList.find(a=>a.symbol=="FUEL")?.mint??""),this.getFleetByKey(t)?.data?.fuelTank,!0)??(()=>{throw new Error("no fleetFuelToken found")})();getCargoStatsDefinition=()=>G().game?.data.cargo.statsDefinition??(()=>{throw new Error("no cargoStatsDefinition found")})();getCargoTypeAddress=t=>ia.CargoType.findAddress(this.getCargoProgram(),this.getCargoStatsDefinition(),t,0)[0]??(()=>{throw new Error("no CargoTypeAddress found")})();getMintBySymbol=t=>new R(H().tokenList.find(a=>a.symbol==t)?.mint??"")??(()=>{throw new Error("no MintBySymbol found")})();getMineItemAddress=t=>la.findAddress(this.getSageProgram(),this.getGameId(),t)[0]??(()=>{throw new Error("no MintBySymbol found")})();getResourceAddress=(t,a)=>ca.findAddress(this.getSageProgram(),t,a)[0]??(()=>{throw new Error("no ResourceAddress found")})();getMiningXpCategory=()=>G().game?.data.points.miningXpCategory?.category??(()=>{throw new Error("no miningXpCategory found")})();getPilotXpCategory=()=>G().game?.data.points.pilotXpCategory?.category??(()=>{throw new Error("no pilotXpCategory found")})();getCouncilRankXpCategory=()=>G().game?.data.points.councilRankXpCategory?.category??(()=>{throw new Error("no councilRankXpCategory found")})();getUserPointsAccountAddress=t=>da.UserPoints.findAddress(this.getPointsProgram(),t,this.getPlayerProfileAddress())[0]??(()=>{throw new Error("no miningXpCategory found")})();getPointsModifierAddress=t=>ua.findPointsModifierAddress(this.getSageProgram(),this.getGameId(),t)[0]??(()=>{throw new Error("no miningXpCategory found")})()}const er=(e,t=254)=>{const a=[...Array(Math.floor(e/t)).keys()].map(()=>t);return e%t>0&&a.push(e%t),a},tr=de({__name:"TokenDeposit",props:["mint","amount","itemType"],setup(e){const t=e,a=yt();async function n(){const r=ke(),i=[],s=new Tt(ke());try{switch(t.itemType){case"ship":i.push(...await s.depositShipToGameIx(t.mint,t.amount));break;case"resource":i.push(...await s.depositCargoToGameIx(t.mint,t.amount));break}i.length>0&&await pt("Instructions Deposit",i,r,At.DEFAULT_FEE),await G().updateStarbasePlayer(),await H().updateStore(r.publicKey())}catch(c){a.notify({type:"warning",message:"warning",caption:c.toString(),position:"bottom-right"})}}return(r,i)=>(D(),ie(J,{color:"primary","icon-right":"call_made",label:"Deposit",onClick:ga(n,["prevent"])}))}});function ar(e,t=2,a=3){e||(e=0);const n=e.toFixed(t).split(".");return n[0]=n[0].padStart(a,"0"),n.join(".")}const rr={class:"col row q-gutter-x-sm justify-end"},sr=["innerHTML"],or=de({__name:"AmountFormatter",props:["number","decimals","padStart","url"],setup(e){const t=e,a=m(()=>{const n=/^(0+)(.+)/,r=ar(t.number,t.decimals,t.padStart).match(n);if(r){const i=r[1],s=r[2];return`
          <div class="row" >
          <span class="text-weight-thin text-grey-7 ">${i}</span>
          <span class="">${s}</span>
          </div>
        `}return`<span class="rest">${t.number}</span>`});return(n,r)=>(D(),le("div",rr,[He("div",{innerHTML:a.value},null,8,sr),q(St,{size:"xs"},{default:j(()=>[q(Pt,{src:e.url},null,8,["src"])]),_:1})]))}}),nr=de({__name:"TokenWithdraw",props:["mint","amount","itemType"],setup(e){const t=e,a=yt();async function n(){const r=ke(),i=[],s=new Tt(ke());try{switch(t.itemType){case"ship":i.push(...await s.withdrawShipFromGameIx(t.mint,t.amount));break;case"resource":i.push(...await s.withdrawCargoFromGameIx(t.mint,t.amount));break}i.length>0&&await pt("Instructions Withdraw",i,r,At.DEFAULT_FEE),await G().updateStarbasePlayer(),await H().updateStore(r.publicKey())}catch(c){a.notify({type:"warning",message:"warning",caption:c.toString(),position:"bottom-right"})}}return(r,i)=>(D(),ie(J,{color:"primary","icon-right":"call_received",label:"Withdraw",onClick:n}))}}),ir={class:"text-grey-5"},lr={key:0},cr={key:1},dr={key:4},Sr=de({__name:"TokenTable",props:{rows:{type:{},required:!0},itemType:{type:String},action:{type:String},selection:{type:String,default:void 0}},setup(e){const t=e,a=X(),n=X([{name:"symbol",required:!0,label:"Symbol",align:"left",field:r=>r.symbol,sortable:!0},{name:"name",required:!0,label:"Name",align:"left",field:r=>r.name,sortable:!0},{name:"uiAmount",required:!0,label:"Available",align:"right",field:r=>r.uiAmount,sortable:!0},{name:"uiAmountSelected",required:!0,label:"Selected",align:"right",field:r=>r.uiAmountSelected,sortable:!1}]);return t.action&&n.value.push({name:"action",required:!0,label:"Action",align:"right",field:r=>r.uiAmountSelected,sortable:!1}),(r,i)=>t.rows?(D(),ie(Ja,{key:0,selected:lt(H)().gameTokenAccountsSelected,"onUpdate:selected":i[1]||(i[1]=s=>lt(H)().gameTokenAccountsSelected=s),columns:n.value,filter:a.value,pagination:{rowsPerPage:0,sortBy:"name",descending:!0},rows:e.rows,selection:e.selection,flat:"","hide-bottom":"","row-key":"name",square:""},{"top-left":j(()=>[He("div",ir,"Found "+$e(e.rows.length)+" Items",1)]),"top-right":j(()=>[q(ct,{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=s=>a.value=s),borderless:"",debounce:"300",dense:"",placeholder:"Search"},{append:j(()=>[q(ee,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell":j(s=>[q(Aa,{props:s},{default:j(()=>[s.col.name=="uiAmount"?(D(),le("div",lr,[q(or,{number:s.row[s.col.name],url:s.row.thumbnailUrl,decimals:"1","pad-start":"10"},null,8,["number","url"])])):s.col.name=="uiAmountSelected"?(D(),le("div",cr,[q(ct,{modelValue:s.row[s.col.name],"onUpdate:modelValue":c=>s.row[s.col.name]=c,modelModifiers:{number:!0},dense:"","input-class":"text-right",standout:"",type:"number"},{append:j(()=>[q(St,{size:"xs"},{default:j(()=>[q(Pt,{src:`${s.row.thumbnailUrl}`},null,8,["src"])]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])])):s.col.name=="action"&&e.action=="deposit"?(D(),ie(tr,{key:2,amount:s.row.uiAmountSelected*Math.pow(10,-s.row.decimals),"item-type":e.itemType,mint:s.row.mint},null,8,["amount","item-type","mint"])):s.col.name=="action"&&e.action=="withdraw"?(D(),ie(nr,{key:3,amount:s.row.uiAmountSelected*Math.pow(10,-s.row.decimals),"item-type":e.itemType,mint:s.row.mint},null,8,["amount","item-type","mint"])):(D(),le("div",dr,$e(s.row[s.col.name]),1))]),_:2},1032,["props"])]),_:1},8,["selected","columns","filter","rows","selection"])):ha("",!0)}}),ur={class:"row text-h4 text-center items-center q-ma-md"},gr={class:"q-mx-md"},wr=de({__name:"InfoBanner",props:["message"],setup(e){return(t,a)=>(D(),le("div",ur,[q(ee,{name:"warning",size:"md"}),q(Le,{class:"col"}),He("div",gr,$e(e.message),1),q(Le,{class:"col"}),q(ee,{name:"warning",size:"md"})]))}});export{Tt as G,Aa as Q,wr as _,Ja as a,Sr as b,or as c,qa as d,ka as e};
