import{Q as Ue}from"./QPage-CEvyMH-5.js";import{o as ie,p as Y,v as He,w as qt,c as X,x as Mt,y as Lt,n as It}from"./QInput-C7Xpa2Au.js";import{g as q,h as z,b as O,a as Ge,Q as ue,L as Bt}from"./LoadingAnimation-CSeYKtkS.js";import{a0 as M,E as F,ae as j,a2 as c,ad as S,a5 as s,b5 as H,ai as E,al as Z,bg as B,bf as f,bh as W,a3 as p,a4 as b,aa as w,a7 as $,w as Se,x as u,y as A,z as Ke,P as U,ab as _,a9 as I,F as xe,bi as Et,bj as ye,G as Vt,I as We,as as Ut,U as Qt,at as Dt,a6 as ee,ak as _e,J as Je,bk as Xe,K as Ce,bl as Nt,bm as Pt,ba as te,a8 as Qe,aC as Rt,b4 as zt,b1 as ke}from"./index-CgQYXkFv.js";import{G,b as Ye,Q as ae,c as De,a as Ze,d as Ot,e as Ne,_ as Pe}from"./InfoBanner.vue_vue_type_script_setup_true_lang-D2GkmSYO.js";import{Q as we}from"./QCardSection-DEWmhi39.js";import{Q as ce,a as jt,u as Ht}from"./QCard-DxchUDww.js";import{Q as Gt}from"./QSpace-f5SktzwU.js";import{Q as Re}from"./QExpansionItem-D9ZuPrmn.js";import{_ as et}from"./HeaderBanner.vue_vue_type_script_setup_true_lang-Do5Pn07H.js";import{T as Kt,Q as Wt}from"./QBadge-qauSicQg.js";import"./use-checkbox-BzKdm-Ud.js";import"./QImg-D8KP8f1R.js";import"./touch-BjYP5sR0.js";const Jt=M({__name:"FleetCreateAction",setup(n){const a=F("test"),d=j();async function i(){const e=q(),l=[],r=new G(q());try{const o=B().gameTokenAccountsSelected[0].mint,V=B().gameTokenAccountsSelected[0].uiAmountSelected;l.push(...r.createNewFleetIx(o,V,a.value)),l.length>0&&await z("Instructions Withdraw",l,e,O.DEFAULT_FEE),f().fleets=await W()}catch(o){d.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),S(Z,null,[s(ie,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=r=>a.value=r),label:"Fleet Name"},null,8,["modelValue"]),s(E,{class:"full-width",color:"primary",label:"Form new fleet",onClick:H(i,["prevent"])})],64))}}),Xt=M({__name:"FleetCreateView",setup(n){return B(),(a,d)=>(c(),p(ce,{flat:""},{default:b(()=>[s(we,null,{default:b(()=>[w(B)().gameTokenAccountsSelected?(c(),p(Jt,{key:0})):$("",!0)]),_:1}),w(B)().walletTokenAccounts?(c(),p(Ye,{key:0,rows:w(B)().gameTokenAccounts?.filter(i=>i.itemType=="ship"),"item-type":"ship",selection:"multiple"},null,8,["rows"])):$("",!0)]),_:1}))}}),Yt=Se({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(n,{slots:a}){const d=u(()=>{const i=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(e=>n[e]===!0).map(e=>`q-btn-group--${e}`).join(" ");return`q-btn-group row no-wrap${i.length!==0?" "+i:""}`+(n.spread===!0?" q-btn-group--spread":" inline")});return()=>A("div",{class:d.value},Ke(a.default))}}),ne=Se({name:"QTr",props:{props:Object,noHover:Boolean},setup(n,{slots:a}){const d=u(()=>"q-tr"+(n.props===void 0||n.props.header===!0?"":" "+n.props.__trClass)+(n.noHover===!0?" q-tr--no-hover":""));return()=>A("tr",{class:d.value},Ke(a.default))}}),Zt=M({__name:"FleetShipAddAction",props:{fleet:{type:U,required:!0}},setup(n){const a=j(),d=n;async function i(){const e=q(),l=[],r=new G(q());try{l.push(...r.addShipsToFleetIx(d.fleet,B().gameTokenAccountsSelected[0]?.mint,B().gameTokenAccountsSelected[0]?.uiAmountSelected)),l.length>0&&await z("Add Ships to fleet",l,e,O.DEFAULT_FEE),f().fleets=await W()}catch(o){a.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),p(E,{class:"full-width",color:"secondary",label:"Add",onClick:H(i,["prevent"])}))}}),ea=M({__name:"FleetShipDisbandAction",props:{fleet:{type:U,required:!0}},setup(n){const a=j(),d=n;async function i(){const e=q(),l=[],r=new G(q());try{l.push(...await r.disbandFleetIx(d.fleet)),l.length>0&&await z("Disband fleet",l,e,O.DEFAULT_FEE),f().fleets=await W()}catch(o){a.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),p(E,{class:"full-width",color:"secondary",label:"Disband",onClick:H(i,["prevent"])}))}}),ta={class:"col text-center"},aa=M({__name:"HeaderBanner2",props:{text:{type:String,default:"none"},caption:{type:String,default:"none"}},setup(n){const a=n;return(d,i)=>(c(),p(ce,{class:"text-h6 row q-gutter-x-md q-ma-md",flat:""},{default:b(()=>[_("div",null,I(a.text),1),_("div",ta,I(a.caption),1)]),_:1}))}}),na=M({__name:"FleetShipDialog",props:{name:{type:String,default:"none"},fleet:{type:U,required:!0}},setup(n){const a=F(!1),d=F("add"),i=n;return xe(()=>a.value,()=>{f().starbaseTokenAccountsSelected=void 0}),(e,l)=>(c(),S(Z,null,[s(E,{color:"secondary",label:"Edit Fleet",onClick:l[0]||(l[0]=r=>a.value=!0)}),s(He,{modelValue:a.value,"onUpdate:modelValue":l[2]||(l[2]=r=>a.value=r),"full-width":"","transition-hide":"rotate","transition-show":"rotate"},{default:b(()=>[s(ce,{bordered:"",flat:""},{default:b(()=>[s(aa,{caption:i.name,text:"Fleet "},null,8,["caption"]),s(Y),s(Ge,{modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=r=>d.value=r),"active-bg-color":"primary",align:"justify","inline-label":""},{default:b(()=>[s(ue,{label:"Add",name:"add"}),s(ue,{label:"Disband",name:"disband"})]),_:1},8,["modelValue"]),s(Y),s(we,null,{default:b(()=>[d.value==="add"&&w(B)().walletTokenAccounts?(c(),p(Ye,{key:0,rows:w(f)().starbaseTokenAccounts?.filter(r=>r.itemType=="ship"),"item-type":"ship",selection:"multiple"},null,8,["rows"])):$("",!0)]),_:1}),s(we,{class:"row"},{default:b(()=>[s(Gt),d.value=="add"?(c(),p(Zt,{key:0,fleet:n.fleet},null,8,["fleet"])):$("",!0),d.value=="disband"?(c(),p(ea,{key:1,fleet:n.fleet},null,8,["fleet"])):$("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),ze="q-slider__marker-labels",la=n=>({value:n}),ra=({marker:n})=>A("div",{key:n.value,style:n.style,class:n.classes},n.label),tt=[34,37,40,33,39,38],oa={...Ht,...qt,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:n=>n>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},sa=["pan","update:modelValue","change"];function ia({updateValue:n,updatePosition:a,getDragging:d,formAttrs:i}){const{props:e,emit:l,slots:r,proxy:{$q:o}}=We(),V=jt(e,o),J=Mt(i),y=F(!1),m=F(!1),v=F(!1),x=F(!1),L=u(()=>e.vertical===!0?"--v":"--h"),de=u(()=>"-"+(e.switchLabelSide===!0?"switched":"standard")),D=u(()=>e.vertical===!0?e.reverse===!0:e.reverse!==(o.lang.rtl===!0)),Q=u(()=>isNaN(e.innerMin)===!0||e.innerMin<e.min?e.min:e.innerMin),N=u(()=>isNaN(e.innerMax)===!0||e.innerMax>e.max?e.max:e.innerMax),C=u(()=>e.disable!==!0&&e.readonly!==!0&&Q.value<N.value),P=u(()=>{if(e.step===0)return g=>g;const t=(String(e.step).trim().split(".")[1]||"").length;return g=>parseFloat(g.toFixed(t))}),K=u(()=>e.step===0?1:e.step),at=u(()=>C.value===!0?e.tabindex||0:-1),le=u(()=>e.max-e.min),Ae=u(()=>N.value-Q.value),re=u(()=>fe(Q.value)),me=u(()=>fe(N.value)),oe=u(()=>e.vertical===!0?D.value===!0?"bottom":"top":D.value===!0?"right":"left"),$e=u(()=>e.vertical===!0?"height":"width"),nt=u(()=>e.vertical===!0?"width":"height"),Fe=u(()=>e.vertical===!0?"vertical":"horizontal"),lt=u(()=>{const t={role:"slider","aria-valuemin":Q.value,"aria-valuemax":N.value,"aria-orientation":Fe.value,"data-step":e.step};return e.disable===!0?t["aria-disabled"]="true":e.readonly===!0&&(t["aria-readonly"]="true"),t}),rt=u(()=>`q-slider q-slider${L.value} q-slider--${y.value===!0?"":"in"}active inline no-wrap `+(e.vertical===!0?"row":"column")+(e.disable===!0?" disabled":" q-slider--enabled"+(C.value===!0?" q-slider--editable":""))+(v.value==="both"?" q-slider--focus":"")+(e.label||e.labelAlways===!0?" q-slider--label":"")+(e.labelAlways===!0?" q-slider--label-always":"")+(V.value===!0?" q-slider--dark":"")+(e.dense===!0?" q-slider--dense q-slider--dense"+L.value:""));function se(t){const g="q-slider__"+t;return`${g} ${g}${L.value} ${g}${L.value}${de.value}`}function Te(t){const g="q-slider__"+t;return`${g} ${g}${L.value}`}const ot=u(()=>{const t=e.selectionColor||e.color;return"q-slider__selection absolute"+(t!==void 0?` text-${t}`:"")}),st=u(()=>Te("markers")+" absolute overflow-hidden"),it=u(()=>Te("track-container")),ut=u(()=>se("pin")),ct=u(()=>se("label")),dt=u(()=>se("text-container")),mt=u(()=>se("marker-labels-container")+(e.markerLabelsClass!==void 0?` ${e.markerLabelsClass}`:"")),ft=u(()=>"q-slider__track relative-position no-outline"+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),gt=u(()=>{const t={[nt.value]:e.trackSize};return e.trackImg!==void 0&&(t.backgroundImage=`url(${e.trackImg}) !important`),t}),vt=u(()=>"q-slider__inner absolute"+(e.innerTrackColor!==void 0?` bg-${e.innerTrackColor}`:"")),qe=u(()=>{const t=me.value-re.value,g={[oe.value]:`${100*re.value}%`,[$e.value]:t===0?"2px":`${100*t}%`};return e.innerTrackImg!==void 0&&(g.backgroundImage=`url(${e.innerTrackImg}) !important`),g});function bt(t){const{min:g,max:k,step:h}=e;let T=g+t*(k-g);if(h>0){const R=(T-Q.value)%h;T+=(Math.abs(R)>=h/2?(R<0?-1:1)*h:0)-R}return T=P.value(T),X(T,Q.value,N.value)}function fe(t){return le.value===0?0:(t-e.min)/le.value}function pt(t,g){const k=Ut(t),h=e.vertical===!0?X((k.top-g.top)/g.height,0,1):X((k.left-g.left)/g.width,0,1);return X(D.value===!0?1-h:h,re.value,me.value)}const Me=u(()=>Et(e.markers)===!0?e.markers:K.value),Le=u(()=>{const t=[],g=Me.value,k=e.max;let h=e.min;do t.push(h),h+=g;while(h<k);return t.push(k),t}),Ie=u(()=>{const t=` ${ze}${L.value}-`;return ze+`${t}${e.switchMarkerLabelsSide===!0?"switched":"standard"}${t}${D.value===!0?"rtl":"ltr"}`}),ge=u(()=>e.markerLabels===!1?null:kt(e.markerLabels).map((t,g)=>({index:g,value:t.value,label:t.label||t.value,classes:Ie.value+(t.classes!==void 0?" "+t.classes:""),style:{...Ee(t.value),...t.style||{}}}))),Be=u(()=>({markerList:ge.value,markerMap:ht.value,classes:Ie.value,getStyle:Ee})),yt=u(()=>{const t=Ae.value===0?"2px":100*Me.value/Ae.value;return{...qe.value,backgroundSize:e.vertical===!0?`2px ${t}%`:`${t}% 2px`}});function kt(t){if(t===!1)return null;if(t===!0)return Le.value.map(la);if(typeof t=="function")return Le.value.map(k=>{const h=t(k);return ye(h)===!0?{...h,value:k}:{value:k,label:h}});const g=({value:k})=>k>=e.min&&k<=e.max;return Array.isArray(t)===!0?t.map(k=>ye(k)===!0?k:{value:k}).filter(g):Object.keys(t).map(k=>{const h=t[k],T=Number(k);return ye(h)===!0?{...h,value:T}:{value:T,label:h}}).filter(g)}function Ee(t){return{[oe.value]:`${100*(t-e.min)/le.value}%`}}const ht=u(()=>{if(e.markerLabels===!1)return null;const t={};return ge.value.forEach(g=>{t[g.value]=g}),t});function _t(){if(r["marker-label-group"]!==void 0)return r["marker-label-group"](Be.value);const t=r["marker-label"]||ra;return ge.value.map(g=>t({marker:g,...Be.value}))}const wt=u(()=>[[Kt,St,void 0,{[Fe.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function St(t){t.isFinal===!0?(x.value!==void 0&&(a(t.evt),t.touch===!0&&n(!0),x.value=void 0,l("pan","end")),y.value=!1,v.value=!1):t.isFirst===!0?(x.value=d(t.evt),a(t.evt),n(),y.value=!0,l("pan","start")):(a(t.evt),n())}function Ve(){v.value=!1}function xt(t){a(t,d(t)),n(),m.value=!0,y.value=!0,document.addEventListener("mouseup",ve,!0)}function ve(){m.value=!1,y.value=!1,n(!0),Ve(),document.removeEventListener("mouseup",ve,!0)}function Ct(t){a(t,d(t)),n(!0)}function At(t){tt.includes(t.keyCode)&&n(!0)}function $t(t){if(e.vertical===!0)return null;const g=o.lang.rtl!==e.reverse?1-t:t;return{transform:`translateX(calc(${2*g-1} * ${e.thumbSize} / 2 + ${50-100*g}%))`}}function Ft(t){const g=u(()=>m.value===!1&&(v.value===t.focusValue||v.value==="both")?" q-slider--focus":""),k=u(()=>`q-slider__thumb q-slider__thumb${L.value} q-slider__thumb${L.value}-${D.value===!0?"rtl":"ltr"} absolute non-selectable`+g.value+(t.thumbColor.value!==void 0?` text-${t.thumbColor.value}`:"")),h=u(()=>({width:e.thumbSize,height:e.thumbSize,[oe.value]:`${100*t.ratio.value}%`,zIndex:v.value===t.focusValue?2:void 0})),T=u(()=>t.labelColor.value!==void 0?` text-${t.labelColor.value}`:""),R=u(()=>$t(t.ratio.value)),be=u(()=>"q-slider__text"+(t.labelTextColor.value!==void 0?` text-${t.labelTextColor.value}`:""));return()=>{const pe=[A("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[A("path",{d:e.thumbPath})]),A("div",{class:"q-slider__focus-ring fit"})];return(e.label===!0||e.labelAlways===!0)&&(pe.push(A("div",{class:ut.value+" absolute fit no-pointer-events"+T.value},[A("div",{class:ct.value,style:{minWidth:e.thumbSize}},[A("div",{class:dt.value,style:R.value},[A("span",{class:be.value},t.label.value)])])])),e.name!==void 0&&e.disable!==!0&&J(pe,"push")),A("div",{class:k.value,style:h.value,...t.getNodeData()},pe)}}function Tt(t,g,k,h){const T=[];e.innerTrackColor!=="transparent"&&T.push(A("div",{key:"inner",class:vt.value,style:qe.value})),e.selectionColor!=="transparent"&&T.push(A("div",{key:"selection",class:ot.value,style:t.value})),e.markers!==!1&&T.push(A("div",{key:"marker",class:st.value,style:yt.value})),h(T);const R=[Qt("div",{key:"trackC",class:it.value,tabindex:g.value,...k.value},[A("div",{class:ft.value,style:gt.value},T)],"slide",C.value,()=>wt.value)];if(e.markerLabels!==!1){const be=e.switchMarkerLabelsSide===!0?"unshift":"push";R[be](A("div",{key:"markerL",class:mt.value},_t()))}return R}return Vt(()=>{document.removeEventListener("mouseup",ve,!0)}),{state:{active:y,focus:v,preventFocus:m,dragging:x,editable:C,classes:rt,tabindex:at,attributes:lt,roundValueFn:P,keyStep:K,trackLen:le,innerMin:Q,innerMinRatio:re,innerMax:N,innerMaxRatio:me,positionProp:oe,sizeProp:$e,isReversed:D},methods:{onActivate:xt,onMobileClick:Ct,onBlur:Ve,onKeyup:At,getContent:Tt,getThumbRenderFn:Ft,convertRatioToModel:bt,convertModelToRatio:fe,getDraggingRatio:pt}}}const ua=()=>({}),ca=Se({name:"QSlider",props:{...oa,modelValue:{required:!0,default:null,validator:n=>typeof n=="number"||n===null},labelValue:[String,Number]},emits:sa,setup(n,{emit:a}){const{proxy:{$q:d}}=We(),{state:i,methods:e}=ia({updateValue:L,updatePosition:D,getDragging:de,formAttrs:Lt(n)}),l=F(null),r=F(0),o=F(0);function V(){o.value=n.modelValue===null?i.innerMin.value:X(n.modelValue,i.innerMin.value,i.innerMax.value)}xe(()=>`${n.modelValue}|${i.innerMin.value}|${i.innerMax.value}`,V),V();const J=u(()=>e.convertModelToRatio(o.value)),y=u(()=>i.active.value===!0?r.value:J.value),m=u(()=>{const C={[i.positionProp.value]:`${100*i.innerMinRatio.value}%`,[i.sizeProp.value]:`${100*(y.value-i.innerMinRatio.value)}%`};return n.selectionImg!==void 0&&(C.backgroundImage=`url(${n.selectionImg}) !important`),C}),v=e.getThumbRenderFn({focusValue:!0,getNodeData:ua,ratio:y,label:u(()=>n.labelValue!==void 0?n.labelValue:o.value),thumbColor:u(()=>n.thumbColor||n.color),labelColor:u(()=>n.labelColor),labelTextColor:u(()=>n.labelTextColor)}),x=u(()=>i.editable.value!==!0?{}:d.platform.is.mobile===!0?{onClick:e.onMobileClick}:{onMousedown:e.onActivate,onFocus:Q,onBlur:e.onBlur,onKeydown:N,onKeyup:e.onKeyup});function L(C){o.value!==n.modelValue&&a("update:modelValue",o.value),C===!0&&a("change",o.value)}function de(){return l.value.getBoundingClientRect()}function D(C,P=i.dragging.value){const K=e.getDraggingRatio(C,P);o.value=e.convertRatioToModel(K),r.value=n.snap!==!0||n.step===0?K:e.convertModelToRatio(o.value)}function Q(){i.focus.value=!0}function N(C){if(tt.includes(C.keyCode)===!1)return;Dt(C);const P=([34,33].includes(C.keyCode)?10:1)*i.keyStep.value,K=([34,37,40].includes(C.keyCode)?-1:1)*(i.isReversed.value===!0?-1:1)*(n.vertical===!0?-1:1)*P;o.value=X(i.roundValueFn.value(o.value+K),i.innerMin.value,i.innerMax.value),L()}return()=>{const C=e.getContent(m,i.tabindex,x,P=>{P.push(v())});return A("div",{ref:l,class:i.classes.value+(n.modelValue===null?" q-slider--no-value":""),...i.attributes.value,"aria-valuenow":n.modelValue},C)}}}),da={class:"row justify-end"},Oe=M({__name:"FleetCargoSyncAction",props:{fleet:{type:U,required:!0},cargoMint:{type:U,required:!0},amount:{type:Number,default:0}},setup(n){const a=n,d=j();async function i(){const e=q(),l=[],r=new G(q());try{a.amount>0&&l.push(...await r.cargoToFleetIx(a.fleet,a.cargoMint,Math.abs(a.amount))),a.amount<0&&l.push(...await r.cargoToStarbaseIx(a.fleet,a.cargoMint,Math.abs(a.amount))),l.length>0&&await z(`Transfer Cargo: ${a.amount>0?"Starbase -> Fleet":"Fleet -> Starbase"}`,l,e,O.DEFAULT_FEE),await f().updateFleet(),await f().updateFleetCargoAccounts(a.fleet)}catch(o){d.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),S("div",da,[s(E,{color:"secondary",label:"Sync",onClick:H(i,["prevent"])})]))}}),ma={class:"text-grey-5"},fa={key:0,class:"col row"},ga={key:1,class:"col row"},va={key:2,class:"col"},ba={class:"row items-center"},pa={class:"row items-center"},ya={class:"col-1"},ka={key:4},ha={class:"row q-gutter-x-sm"},_a={class:"col"},wa={class:"row items-center"},Sa={class:"col row items-center"},xa={class:"col row items-center"},je=M({__name:"CargoTable",props:{fleet:{type:U,required:!0},rows:{type:{},required:!0},action:{type:String}},setup(n){const a=n,d=F(),i=F([{style:"width: 10px",name:"extend",required:!0,align:"left",sortable:!1},{name:"symbol",required:!0,label:"Symbol",align:"left",field:y=>y?.symbol,sortable:!0},{name:"name",required:!0,label:"Name",align:"left",field:y=>y?.name,sortable:!0},{name:"uiAmount",required:!0,label:"Quantity",align:"right",field:y=>y.uiAmount,sortable:!0},{style:"width: 10px",name:"extend2",required:!0,align:"left",sortable:!1}]),e=u(()=>{const y=f()?.fleetFuelAccount?.uiAmount;return f().fleets?.find(m=>m.key.toString()==a.fleet.toString())?.data.stats.cargoStats.fuelCapacity-(y??0)}),l=u(()=>{const y=f()?.fleetAmmoAccount?.uiAmount;return f().fleets?.find(m=>m.key.toString()==a.fleet.toString())?.data.stats.cargoStats.ammoCapacity-(y??0)}),r=u(()=>{const y=f()?.fleetCargoAccounts?.flatMap(m=>m.uiAmount)?.reduce((m,v)=>m+v,0);return f().fleets?.find(m=>m.key.toString()==a.fleet.toString())?.data.stats.cargoStats.cargoCapacity-(y??0)});function o(y){switch(B().tokenList.find(m=>m.mint.toString()==y.toString())?.symbol){case"FUEL":return f().fleets?.find(m=>m.key.toString()==a.fleet.toString())?.data.stats.cargoStats.fuelCapacity;case"AMMO":return f().fleets?.find(m=>m.key.toString()==a.fleet.toString())?.data.stats.cargoStats.ammoCapacity;default:return f().fleets?.find(m=>m.key.toString()==a.fleet.toString())?.data.stats.cargoStats.cargoCapacity}}function V(y){switch(B().tokenList.find(m=>m.mint.toString()==y.toString())?.symbol){case"FUEL":return e.value;case"AMMO":return l.value;default:return r.value}}function J(y){switch(B().tokenList.find(m=>m.mint.toString()==y.toString())?.symbol){case"FUEL":return f().fleetFuelAccount?.uiAmount||0;case"AMMO":return f().fleetAmmoAccount?.uiAmount||0;default:return f().fleetCargoAccounts?.find(m=>m.mint.toString()==y.toString())?.uiAmount||0}}return(y,m)=>a.rows?(c(),p(Ze,{key:0,columns:i.value,filter:d.value,pagination:{rowsPerPage:0,sortBy:"name",descending:!0},rows:a.rows,dense:"",flat:"","hide-bottom":"","row-key":"name",square:""},{"top-left":b(()=>[_("div",ma,"Found "+I(n.rows.length)+" Items",1)]),"top-right":b(()=>[s(ie,{modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=v=>d.value=v),borderless:"",debounce:"300",dense:"",placeholder:"Search"},{append:b(()=>[s(ee,{name:"search"})]),_:1},8,["modelValue"])]),body:b(v=>[s(ne,{props:v,onClick:x=>v.expand=!v.expand},{default:b(()=>[(c(!0),S(Z,null,_e(v.cols,x=>(c(),p(ae,{key:x.name,props:v},{default:b(()=>[x.name=="extend"?(c(),S("div",fa,[s(ee,{name:v.expand?"expand_less":"expand_more",size:"lg"},null,8,["name"])])):x.name=="extend2"?(c(),S("div",ga,[s(ee,{name:v.expand?"expand_less":"expand_more",size:"lg"},null,8,["name"])])):x.name=="uiAmount"?(c(),S("div",va,[_("div",ba,[m[1]||(m[1]=_("div",{class:"col"},"@Starbase",-1)),m[2]||(m[2]=_("div",{class:"col-1"},"∞",-1)),s(De,{number:w(f)().starbaseTokenAccounts?.find(L=>L.mint.toString()==v.row.mint.toString())?.uiAmount??0,url:v.row.thumbnailUrl,class:"col",decimals:"1","pad-start":"10"},null,8,["number","url"])]),_("div",pa,[m[3]||(m[3]=_("div",{class:"col"},"@Cargo",-1)),_("div",ya,I(((J(v.row.mint)+v.row.uiAmountChange)/o(v.row.mint)*100).toFixed(0))+"% ",1),s(De,{number:J(v.row.mint),url:v.row.thumbnailUrl,class:"col",decimals:"1","pad-start":"10"},null,8,["number","url"])])])):x.name=="action"&&n.action=="sync"?(c(),p(Oe,{key:3,"cargo-mint":v.row.mint,fleet:a.fleet,"is-amount":0,"should-amount":0},null,8,["cargo-mint","fleet"])):(c(),S("div",ka,I(x.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick"]),Je(s(ne,{props:v},{default:b(()=>[s(ae,{class:"",colspan:"100%"},{default:b(()=>[_("div",ha,[_("div",_a,[_("div",wa,[_("div",Sa,[_("div",xa,[m[4]||(m[4]=_("div",{class:"text-subtitle2"},"@Starbase",-1)),s(ca,{modelValue:v.row.uiAmountChange,"onUpdate:modelValue":x=>v.row.uiAmountChange=x,max:V(v.row.mint),min:-v.row.uiAmount,step:1,class:"col q-mx-md",color:"accent",label:""},null,8,["modelValue","onUpdate:modelValue","max","min"]),m[5]||(m[5]=_("div",{class:"text-subtitle2"},"@Cargo",-1))])])]),s(ie,{modelValue:v.row.uiAmountChange,"onUpdate:modelValue":x=>v.row.uiAmountChange=x,class:"col",dense:"",standout:"",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),s(Oe,{amount:v.row.uiAmountChange,"cargo-mint":v.row.mint,fleet:a.fleet},null,8,["amount","cargo-mint","fleet"])])]),_:2},1024)]),_:2},1032,["props"]),[[Xe,v.expand]])]),_:1},8,["columns","filter","rows"])):$("",!0)}}),Ca=M({__name:"FleetCargoDialog",props:{name:{type:String,default:"none"},fleet:{type:U,required:!0}},setup(n){const a=F(!1),d=n;return u(()=>f().fleets.find(i=>i.key==d.fleet)),xe(()=>a.value,async()=>{await f().updateFleetCargoAccounts(d.fleet),f().starbaseTokenAccountsSelected=void 0}),(i,e)=>(c(),S(Z,null,[s(E,{color:"secondary",label:"Edit Cargo",onClick:e[0]||(e[0]=l=>a.value=!0)}),s(He,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value=l),"full-width":"","transition-hide":"rotate","transition-show":"rotate"},{default:b(()=>[s(ce,{bordered:"",flat:""},{default:b(()=>[s(et,{text:"Cargo"}),s(Y),s(Re,{caption:"Consumed Resources","default-opened":"","expand-separator":"",icon:"perm_identity",label:"Fleet Provision"},{default:b(()=>[w(f)().fleetFilteredConsumptionAccounts?(c(),p(je,{key:0,fleet:d.fleet,rows:w(f)().fleetFilteredConsumptionAccounts,action:"sync",class:"bg-primary"},null,8,["fleet","rows"])):$("",!0)]),_:1}),s(Y,{style:{height:"10px"}}),s(Re,{caption:"Cargo fleet storage","default-opened":"","expand-separator":"",icon:"perm_identity",label:"Fleet Cargo"},{default:b(()=>[w(f)().fleetFilteredCargoAccounts?(c(),p(je,{key:0,fleet:d.fleet,rows:w(f)().fleetFilteredCargoAccounts,action:"sync",class:"bg-primary"},null,8,["fleet","rows"])):$("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Aa={class:"row"},$a=M({__name:"FleetDockAction",props:{fleet:{type:U,required:!0}},setup(n){const a=n,d=j();async function i(){const e=q(),l=[],r=new G(q());try{l.push(...await r.fleetDock(a.fleet)),l.length>0&&await z("Instructions Withdraw",l,e,O.DEFAULT_FEE),f().fleets=await W()}catch(o){d.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),S("div",Aa,[s(E,{color:"secondary",label:"Dock",onClick:H(i,["prevent"])})]))}}),Fa={class:"row"},Ta=M({__name:"FleetUndockAction",props:{fleet:{type:U,required:!0}},setup(n){const a=n,d=j();async function i(){const e=q(),l=[],r=new G(q());try{l.push(...await r.fleetUndock(a.fleet)),l.length>0&&await z("Instructions Withdraw",l,e,O.DEFAULT_FEE),f().fleets=await W()}catch(o){d.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),S("div",Fa,[s(E,{color:"secondary",label:"Undock",onClick:H(i,["prevent"])})]))}}),qa={class:"row"},Ma=M({__name:"FleetStartMiningAction",props:{fleet:{type:U,required:!0}},setup(n){const a=n,d=j();async function i(){const e=q(),l=[],r=new G(q());try{l.push(...await r.startMining(a.fleet)),l.length>0&&await z("Instructions start mining",l,e,O.DEFAULT_FEE),f().fleets=await W()}catch(o){d.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),S("div",qa,[s(E,{color:"secondary",label:"Start mining",onClick:H(i,["prevent"])})]))}}),La={class:"row"},Ia=M({__name:"FleetStopMiningAction",props:{fleet:{type:U,required:!0}},setup(n){const a=n,d=j();async function i(){const e=q(),l=[],r=new G(q());try{l.push(...await r.asteroidMiningHandler(a.fleet)),l.push(...await r.stopMining(a.fleet)),l.length>0&&await z("Instructions stop mining",l,e,O.DEFAULT_FEE),f().fleets=await W()}catch(o){d.notify({type:"warning",message:"warning",caption:o.toString(),position:"bottom-right"})}}return(e,l)=>(c(),S("div",La,[s(E,{color:"secondary",label:"Stop mining",onClick:H(i,["prevent"])})]))}}),Ba={class:"col"},Ea={class:"absolute-full flex flex-center"},Va={class:"col text-center"},he=M({__name:"FleetCargoElement",props:{symbol:{type:String,default:"CARGOELEMENT"},fleet:{type:String,required:!0},max:{type:Number,default:0}},setup(n){const a=n;function d(){switch(a.symbol){case"AMMO":return f().fleets?.find(o=>o.key.toString()==a.fleet?.toString())?.data.stats.cargoStats.ammoCapacity;case"FUEL":return f().fleets?.find(o=>o.key.toString()==a.fleet?.toString())?.data.stats.cargoStats.fuelCapacity;case"CARGO":return f().fleets?.find(o=>o.key.toString()==a.fleet?.toString())?.data.stats.cargoStats.cargoCapacity}}function i(){switch(a.symbol){case"AMMO":return f().fleets?.find(o=>o.key.toString()==a.fleet?.toString())?.data.ammoBank;case"FUEL":return f().fleets?.find(o=>o.key.toString()==a.fleet?.toString())?.data.fuelTank;case"CARGO":return f().fleets?.find(o=>o.key.toString()==a.fleet?.toString())?.data.cargoHold}}const e=F(0);Ce(async()=>{e.value=Nt(await Pt([i()])).flatMap(o=>o.uiAmount).reduce((o,V)=>o+V,0)});const l=u(()=>(e.value/d()).toFixed(3)),r=u(()=>{switch(a.symbol){case"AMMO":return"orange";case"FUEL":return"purple";case"CARGO":return"blue";default:return"red"}});return(o,V)=>(c(),S("div",Ba,[s(Ot,{color:r.value,value:l.value,class:"q-mb-xs","font-size":"16px","show-value":"",size:"20px","track-color":"grey-3"},{default:b(()=>[_("div",Ea,[s(Wt,{label:l.value*100,color:"white","text-color":"accent"},null,8,["label"])])]),_:1},8,["color","value"]),_("div",Va,I(e.value)+"/"+I(d()),1)]))}}),Ua={class:"text-grey-5"},Qa={key:0,class:"row q-gutter-x-sm justify-end"},Da={key:4},Na={class:"text-left"},Pa=M({__name:"FleetTable",props:{rows:{type:{},required:!0}},setup(n){const a=n,d=F();Ce(async()=>{});const i=F([{name:"extend",required:!0,align:"left",sortable:!1},{name:"fleetLabel",required:!0,label:"Fleet name",align:"left",field:e=>te.byteArrayToString(e.data.fleetLabel),sortable:!0},{name:"state",required:!0,label:"State",align:"left",field:e=>Object.keys(e.state)[0]=="MineAsteroid"?"MineAsteroid":Object.keys(e.state)[0],sortable:!0},{name:"fuel",required:!0,label:"Fuel",align:"center",field:e=>e.data.fuelTank,sortable:!0},{name:"ammo",required:!0,label:"Ammo",align:"center",field:e=>e.data.ammoBank,sortable:!0},{name:"cargo",required:!0,label:"Cargo",align:"center",field:e=>e.data.ammoBank,sortable:!0},{name:"actions",required:!1,label:"Actions",align:"right",sortable:!1}]);return(e,l)=>a.rows?(c(),p(Ze,{key:0,columns:i.value,filter:d.value,pagination:{rowsPerPage:0,sortBy:"name",descending:!0},rows:n.rows,flat:"","hide-bottom":"","row-key":"name",square:""},{"top-left":b(()=>[_("div",Ua,"Found "+I(n.rows.length)+" Items",1)]),"top-right":b(()=>[s(Yt,null,{default:b(()=>[s(ie,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=r=>d.value=r),debounce:"300",dense:"",placeholder:"Search",standout:""},{append:b(()=>[s(ee,{name:"search"})]),_:1},8,["modelValue"]),s(E,{color:"primary",icon:"refresh",square:"",onClick:l[1]||(l[1]=r=>w(f)().updateFleet())})]),_:1})]),header:b(r=>[s(ne,{props:r},{default:b(()=>[s(Ne,{"auto-width":""}),(c(!0),S(Z,null,_e(r.cols,o=>(c(),p(Ne,{key:o.name,props:r},{default:b(()=>[Qe(I(o.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:b(r=>[s(ne,{props:r},{default:b(()=>[s(ae,{"auto-width":""},{default:b(()=>[s(E,{icon:r.expand?"remove":"add",color:"accent",dense:"",round:"",size:"sm",onClick:o=>r.expand=!r.expand},null,8,["icon","onClick"])]),_:2},1024),(c(!0),S(Z,null,_e(r.cols,o=>(c(),p(ae,{key:o.name,props:r},{default:b(()=>[o.name=="actions"?(c(),S("div",Qa,[Qe(I()+" ",1),r.row.state.StarbaseLoadingBay?(c(),p(na,{key:0,fleet:r.row.key,name:w(te.byteArrayToString)(r.row.data.fleetLabel)},null,8,["fleet","name"])):$("",!0),r.row.state.StarbaseLoadingBay?(c(),p(Ca,{key:1,fleet:r.row.key,name:w(te.byteArrayToString)(r.row.data.fleetLabel)},null,8,["fleet","name"])):$("",!0),r.row.state.Idle?(c(),p($a,{key:2,fleet:r.row.key},null,8,["fleet"])):$("",!0),r.row.state.StarbaseLoadingBay?(c(),p(Ta,{key:3,fleet:r.row.key},null,8,["fleet"])):$("",!0),r.row.state.Idle?(c(),p(Ma,{key:4,fleet:r.row.key},null,8,["fleet"])):$("",!0),r.row.state.MineAsteroid?(c(),p(Ia,{key:5,fleet:r.row.key},null,8,["fleet"])):$("",!0)])):o.name=="fuel"?(c(),p(he,{key:1,fleet:r.row.key.toString(),symbol:"FUEL"},null,8,["fleet"])):o.name=="ammo"?(c(),p(he,{key:2,fleet:r.row.key.toString(),symbol:"AMMO"},null,8,["fleet"])):o.name=="cargo"?(c(),p(he,{key:3,fleet:r.row.key.toString(),symbol:"CARGO"},null,8,["fleet"])):(c(),S("div",Da,I(o.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),Je(s(ne,{props:r},{default:b(()=>[s(ae,{colspan:"100%"},{default:b(()=>[l[2]||(l[2]=_("div",null,null,-1)),_("div",Na,I(JSON.stringify(r.row,null,2))+".",1)]),_:2},1024)]),_:2},1032,["props"]),[[Xe,r.expand]])]),_:1},8,["columns","filter","rows"])):$("",!0)}}),Ra={key:2},nn=M({__name:"FleetPage",setup(n){const a=F("manage");return Ce(async()=>{await Rt().updateStore(zt()),await ke().updateStore()}),(d,i)=>w(ke)().starbases?.length?(c(),p(Ue,{key:1,class:""},{default:b(()=>[s(et,{text:"Fleet Manager"}),_("div",null,[s(Y),s(Ge,{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=e=>a.value=e),"active-bg-color":"primary",align:"justify","inline-label":""},{default:b(()=>[s(ue,{label:"Manage",name:"manage"}),s(ue,{label:"Create",name:"create"})]),_:1},8,["modelValue"]),s(Y),!w(f)().fleets?.length&&a.value=="manage"?(c(),p(Pe,{key:0,message:"Fleets found"})):a.value=="manage"?(c(),p(Pa,{key:1,rows:w(f)().fleets},null,8,["rows"])):$("",!0),a.value=="create"?(c(),S("div",Ra,[s(It,{modelValue:w(f)().currentStarbase,"onUpdate:modelValue":i[1]||(i[1]=e=>w(f)().currentStarbase=e),disable:!0,"option-label":e=>w(te.byteArrayToString)(e.data.name),options:w(ke)().starbases?.filter(e=>w(te.byteArrayToString)(e.data.name).includes("Central")),class:"",label:"Selected Starbase",square:"",standout:""},{prepend:b(()=>[s(ee,{name:"home"})]),_:1},8,["modelValue","option-label","options"]),w(f)().currentStarbase?(c(),p(Xt,{key:1})):(c(),p(Pe,{key:0,message:"Please select a starbase"}))])):$("",!0)])]),_:1})):(c(),p(Ue,{key:0,class:"row justify-center items-center"},{default:b(()=>[s(Bt)]),_:1}))}});export{nn as default};
