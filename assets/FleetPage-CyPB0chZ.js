import{Q as Be}from"./QPage-Bb5qWfDF.js";import{o as ne,t as je,v as Ft,c as Y,w as Tt,x as qt,n as Mt}from"./QSelect-Dt9Q8nU2.js";import{g as q,h as j,b as H,a as He,Q as ie,L as Lt}from"./LoadingAnimation-BDtYFYMP.js";import{a0 as M,E as T,ae as O,a2 as c,ad as $,a5 as i,b5 as G,ai as I,al as Z,bg as V,b1 as D,bh as J,a3 as y,a4 as g,aa as _,a7 as A,w as _e,x as s,y as x,z as Oe,P as B,ab as k,a9 as E,F as ke,bf as p,bi as It,bj as ye,G as Vt,I as Ge,as as Bt,U as Et,at as Dt,a6 as Se,ak as he,J as Ke,bk as We,ba as ee,a8 as Ee,K as Ut,aC as Qt,b4 as Nt}from"./index-BdeW4lkO.js";import{G as K,b as Je,Q as te,c as De,a as Xe,d as Ue,_ as Qe}from"./InfoBanner.vue_vue_type_script_setup_true_lang-Dgndrhm1.js";import{Q as we}from"./QCardSection-BcVhbc9n.js";import{Q as ce,a as Pt,u as Rt}from"./QCard-a92KV0bw.js";import{Q as ue,_ as Ye}from"./HeaderBanner.vue_vue_type_script_setup_true_lang-DncRMDP1.js";import{Q as zt}from"./QSpace-DAYOcPgx.js";import{Q as Ne}from"./QExpansionItem-Bmu7lEsJ.js";import{T as jt}from"./TouchPan-Df7KDShW.js";import"./use-checkbox-Ds9k3EQx.js";import"./QImg-FbpK5L2E.js";import"./touch-BjYP5sR0.js";const Ht=M({__name:"FleetCreateAction",setup(a){const n=T("test"),u=O();async function o(){const e=q(),l=[],r=new K(q());try{const d=V().gameTokenAccountsSelected[0].mint,Q=V().gameTokenAccountsSelected[0].uiAmountSelected;l.push(...r.createNewFleetIx(d,Q,n.value)),l.length>0&&await j("Instructions Withdraw",l,e,H.DEFAULT_FEE),D().fleets=await J()}catch(d){u.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),$(Z,null,[i(ue,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=r=>n.value=r),label:"Fleet Name"},null,8,["modelValue"]),i(I,{class:"full-width",color:"primary",label:"Form new fleet",onClick:G(o,["prevent"])})],64))}}),Ot=M({__name:"FleetCreateView",setup(a){return V(),(n,u)=>(c(),y(ce,{flat:""},{default:g(()=>[i(we,null,{default:g(()=>[_(V)().gameTokenAccountsSelected?(c(),y(Ht,{key:0})):A("",!0)]),_:1}),_(V)().walletTokenAccounts?(c(),y(Je,{key:0,rows:_(V)().gameTokenAccounts?.filter(o=>o.itemType=="ship"),"item-type":"ship",selection:"multiple"},null,8,["rows"])):A("",!0)]),_:1}))}}),Gt=_e({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(a,{slots:n}){const u=s(()=>{const o=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(e=>a[e]===!0).map(e=>`q-btn-group--${e}`).join(" ");return`q-btn-group row no-wrap${o.length!==0?" "+o:""}`+(a.spread===!0?" q-btn-group--spread":" inline")});return()=>x("div",{class:u.value},Oe(n.default))}}),ae=_e({name:"QTr",props:{props:Object,noHover:Boolean},setup(a,{slots:n}){const u=s(()=>"q-tr"+(a.props===void 0||a.props.header===!0?"":" "+a.props.__trClass)+(a.noHover===!0?" q-tr--no-hover":""));return()=>x("tr",{class:u.value},Oe(n.default))}}),Kt=M({__name:"FleetShipAddAction",props:{fleet:{type:B,required:!0}},setup(a){const n=O(),u=a;async function o(){const e=q(),l=[],r=new K(q());try{l.push(...r.addShipsToFleetIx(u.fleet,V().gameTokenAccountsSelected[0]?.mint,V().gameTokenAccountsSelected[0]?.uiAmountSelected)),l.length>0&&await j("Add Ships to fleet",l,e,H.DEFAULT_FEE),D().fleets=await J()}catch(d){n.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),y(I,{class:"full-width",color:"secondary",label:"Add",onClick:G(o,["prevent"])}))}}),Wt=M({__name:"FleetShipDisbandAction",props:{fleet:{type:B,required:!0}},setup(a){const n=O(),u=a;async function o(){const e=q(),l=[],r=new K(q());try{l.push(...await r.disbandFleetIx(u.fleet)),l.length>0&&await j("Disband fleet",l,e,H.DEFAULT_FEE),D().fleets=await J()}catch(d){n.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),y(I,{class:"full-width",color:"secondary",label:"Disband",onClick:G(o,["prevent"])}))}}),Jt={class:"col text-center"},Xt=M({__name:"HeaderBanner2",props:{text:{type:String,default:"none"},caption:{type:String,default:"none"}},setup(a){const n=a;return(u,o)=>(c(),y(ce,{class:"text-h6 row q-gutter-x-md q-ma-md",flat:""},{default:g(()=>[k("div",null,E(n.text),1),k("div",Jt,E(n.caption),1)]),_:1}))}}),Yt=M({__name:"FleetShipDialog",props:{name:{type:String,default:"none"},fleet:{type:B,required:!0}},setup(a){const n=T(!1),u=T("add"),o=a;return ke(()=>n.value,()=>{p().starbaseTokenAccountsSelected=void 0}),(e,l)=>(c(),$(Z,null,[i(I,{color:"secondary",label:"Edit Fleet",onClick:l[0]||(l[0]=r=>n.value=!0)}),i(je,{modelValue:n.value,"onUpdate:modelValue":l[2]||(l[2]=r=>n.value=r),"full-width":"","transition-hide":"rotate","transition-show":"rotate"},{default:g(()=>[i(ce,{bordered:"",flat:""},{default:g(()=>[i(Xt,{caption:o.name,text:"Fleet "},null,8,["caption"]),i(ne),i(He,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=r=>u.value=r),"active-bg-color":"primary",align:"justify","inline-label":""},{default:g(()=>[i(ie,{label:"Add",name:"add"}),i(ie,{label:"Disband",name:"disband"})]),_:1},8,["modelValue"]),i(ne),i(we,null,{default:g(()=>[u.value==="add"&&_(V)().walletTokenAccounts?(c(),y(Je,{key:0,rows:_(p)().starbaseTokenAccounts?.filter(r=>r.itemType=="ship"),"item-type":"ship",selection:"multiple"},null,8,["rows"])):A("",!0)]),_:1}),i(we,{class:"row"},{default:g(()=>[i(zt),u.value=="add"?(c(),y(Kt,{key:0,fleet:a.fleet},null,8,["fleet"])):A("",!0),u.value=="disband"?(c(),y(Wt,{key:1,fleet:a.fleet},null,8,["fleet"])):A("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Pe="q-slider__marker-labels",Zt=a=>({value:a}),ea=({marker:a})=>x("div",{key:a.value,style:a.style,class:a.classes},a.label),Ze=[34,37,40,33,39,38],ta={...Rt,...Ft,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:a=>a>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},aa=["pan","update:modelValue","change"];function na({updateValue:a,updatePosition:n,getDragging:u,formAttrs:o}){const{props:e,emit:l,slots:r,proxy:{$q:d}}=Ge(),Q=Pt(e,d),X=Tt(o),b=T(!1),m=T(!1),v=T(!1),C=T(!1),L=s(()=>e.vertical===!0?"--v":"--h"),de=s(()=>"-"+(e.switchLabelSide===!0?"switched":"standard")),N=s(()=>e.vertical===!0?e.reverse===!0:e.reverse!==(d.lang.rtl===!0)),U=s(()=>isNaN(e.innerMin)===!0||e.innerMin<e.min?e.min:e.innerMin),P=s(()=>isNaN(e.innerMax)===!0||e.innerMax>e.max?e.max:e.innerMax),S=s(()=>e.disable!==!0&&e.readonly!==!0&&U.value<P.value),R=s(()=>{if(e.step===0)return f=>f;const t=(String(e.step).trim().split(".")[1]||"").length;return f=>parseFloat(f.toFixed(t))}),W=s(()=>e.step===0?1:e.step),et=s(()=>S.value===!0?e.tabindex||0:-1),le=s(()=>e.max-e.min),Ce=s(()=>P.value-U.value),re=s(()=>fe(U.value)),me=s(()=>fe(P.value)),oe=s(()=>e.vertical===!0?N.value===!0?"bottom":"top":N.value===!0?"right":"left"),xe=s(()=>e.vertical===!0?"height":"width"),tt=s(()=>e.vertical===!0?"width":"height"),Ae=s(()=>e.vertical===!0?"vertical":"horizontal"),at=s(()=>{const t={role:"slider","aria-valuemin":U.value,"aria-valuemax":P.value,"aria-orientation":Ae.value,"data-step":e.step};return e.disable===!0?t["aria-disabled"]="true":e.readonly===!0&&(t["aria-readonly"]="true"),t}),nt=s(()=>`q-slider q-slider${L.value} q-slider--${b.value===!0?"":"in"}active inline no-wrap `+(e.vertical===!0?"row":"column")+(e.disable===!0?" disabled":" q-slider--enabled"+(S.value===!0?" q-slider--editable":""))+(v.value==="both"?" q-slider--focus":"")+(e.label||e.labelAlways===!0?" q-slider--label":"")+(e.labelAlways===!0?" q-slider--label-always":"")+(Q.value===!0?" q-slider--dark":"")+(e.dense===!0?" q-slider--dense q-slider--dense"+L.value:""));function se(t){const f="q-slider__"+t;return`${f} ${f}${L.value} ${f}${L.value}${de.value}`}function $e(t){const f="q-slider__"+t;return`${f} ${f}${L.value}`}const lt=s(()=>{const t=e.selectionColor||e.color;return"q-slider__selection absolute"+(t!==void 0?` text-${t}`:"")}),rt=s(()=>$e("markers")+" absolute overflow-hidden"),ot=s(()=>$e("track-container")),st=s(()=>se("pin")),it=s(()=>se("label")),ut=s(()=>se("text-container")),ct=s(()=>se("marker-labels-container")+(e.markerLabelsClass!==void 0?` ${e.markerLabelsClass}`:"")),dt=s(()=>"q-slider__track relative-position no-outline"+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),mt=s(()=>{const t={[tt.value]:e.trackSize};return e.trackImg!==void 0&&(t.backgroundImage=`url(${e.trackImg}) !important`),t}),ft=s(()=>"q-slider__inner absolute"+(e.innerTrackColor!==void 0?` bg-${e.innerTrackColor}`:"")),Fe=s(()=>{const t=me.value-re.value,f={[oe.value]:`${100*re.value}%`,[xe.value]:t===0?"2px":`${100*t}%`};return e.innerTrackImg!==void 0&&(f.backgroundImage=`url(${e.innerTrackImg}) !important`),f});function vt(t){const{min:f,max:h,step:w}=e;let F=f+t*(h-f);if(w>0){const z=(F-U.value)%w;F+=(Math.abs(z)>=w/2?(z<0?-1:1)*w:0)-z}return F=R.value(F),Y(F,U.value,P.value)}function fe(t){return le.value===0?0:(t-e.min)/le.value}function gt(t,f){const h=Bt(t),w=e.vertical===!0?Y((h.top-f.top)/f.height,0,1):Y((h.left-f.left)/f.width,0,1);return Y(N.value===!0?1-w:w,re.value,me.value)}const Te=s(()=>It(e.markers)===!0?e.markers:W.value),qe=s(()=>{const t=[],f=Te.value,h=e.max;let w=e.min;do t.push(w),w+=f;while(w<h);return t.push(h),t}),Me=s(()=>{const t=` ${Pe}${L.value}-`;return Pe+`${t}${e.switchMarkerLabelsSide===!0?"switched":"standard"}${t}${N.value===!0?"rtl":"ltr"}`}),ve=s(()=>e.markerLabels===!1?null:bt(e.markerLabels).map((t,f)=>({index:f,value:t.value,label:t.label||t.value,classes:Me.value+(t.classes!==void 0?" "+t.classes:""),style:{...Ie(t.value),...t.style||{}}}))),Le=s(()=>({markerList:ve.value,markerMap:yt.value,classes:Me.value,getStyle:Ie})),pt=s(()=>{const t=Ce.value===0?"2px":100*Te.value/Ce.value;return{...Fe.value,backgroundSize:e.vertical===!0?`2px ${t}%`:`${t}% 2px`}});function bt(t){if(t===!1)return null;if(t===!0)return qe.value.map(Zt);if(typeof t=="function")return qe.value.map(h=>{const w=t(h);return ye(w)===!0?{...w,value:h}:{value:h,label:w}});const f=({value:h})=>h>=e.min&&h<=e.max;return Array.isArray(t)===!0?t.map(h=>ye(h)===!0?h:{value:h}).filter(f):Object.keys(t).map(h=>{const w=t[h],F=Number(h);return ye(w)===!0?{...w,value:F}:{value:F,label:w}}).filter(f)}function Ie(t){return{[oe.value]:`${100*(t-e.min)/le.value}%`}}const yt=s(()=>{if(e.markerLabels===!1)return null;const t={};return ve.value.forEach(f=>{t[f.value]=f}),t});function ht(){if(r["marker-label-group"]!==void 0)return r["marker-label-group"](Le.value);const t=r["marker-label"]||ea;return ve.value.map(f=>t({marker:f,...Le.value}))}const wt=s(()=>[[jt,_t,void 0,{[Ae.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function _t(t){t.isFinal===!0?(C.value!==void 0&&(n(t.evt),t.touch===!0&&a(!0),C.value=void 0,l("pan","end")),b.value=!1,v.value=!1):t.isFirst===!0?(C.value=u(t.evt),n(t.evt),a(),b.value=!0,l("pan","start")):(n(t.evt),a())}function Ve(){v.value=!1}function kt(t){n(t,u(t)),a(),m.value=!0,b.value=!0,document.addEventListener("mouseup",ge,!0)}function ge(){m.value=!1,b.value=!1,a(!0),Ve(),document.removeEventListener("mouseup",ge,!0)}function St(t){n(t,u(t)),a(!0)}function Ct(t){Ze.includes(t.keyCode)&&a(!0)}function xt(t){if(e.vertical===!0)return null;const f=d.lang.rtl!==e.reverse?1-t:t;return{transform:`translateX(calc(${2*f-1} * ${e.thumbSize} / 2 + ${50-100*f}%))`}}function At(t){const f=s(()=>m.value===!1&&(v.value===t.focusValue||v.value==="both")?" q-slider--focus":""),h=s(()=>`q-slider__thumb q-slider__thumb${L.value} q-slider__thumb${L.value}-${N.value===!0?"rtl":"ltr"} absolute non-selectable`+f.value+(t.thumbColor.value!==void 0?` text-${t.thumbColor.value}`:"")),w=s(()=>({width:e.thumbSize,height:e.thumbSize,[oe.value]:`${100*t.ratio.value}%`,zIndex:v.value===t.focusValue?2:void 0})),F=s(()=>t.labelColor.value!==void 0?` text-${t.labelColor.value}`:""),z=s(()=>xt(t.ratio.value)),pe=s(()=>"q-slider__text"+(t.labelTextColor.value!==void 0?` text-${t.labelTextColor.value}`:""));return()=>{const be=[x("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[x("path",{d:e.thumbPath})]),x("div",{class:"q-slider__focus-ring fit"})];return(e.label===!0||e.labelAlways===!0)&&(be.push(x("div",{class:st.value+" absolute fit no-pointer-events"+F.value},[x("div",{class:it.value,style:{minWidth:e.thumbSize}},[x("div",{class:ut.value,style:z.value},[x("span",{class:pe.value},t.label.value)])])])),e.name!==void 0&&e.disable!==!0&&X(be,"push")),x("div",{class:h.value,style:w.value,...t.getNodeData()},be)}}function $t(t,f,h,w){const F=[];e.innerTrackColor!=="transparent"&&F.push(x("div",{key:"inner",class:ft.value,style:Fe.value})),e.selectionColor!=="transparent"&&F.push(x("div",{key:"selection",class:lt.value,style:t.value})),e.markers!==!1&&F.push(x("div",{key:"marker",class:rt.value,style:pt.value})),w(F);const z=[Et("div",{key:"trackC",class:ot.value,tabindex:f.value,...h.value},[x("div",{class:dt.value,style:mt.value},F)],"slide",S.value,()=>wt.value)];if(e.markerLabels!==!1){const pe=e.switchMarkerLabelsSide===!0?"unshift":"push";z[pe](x("div",{key:"markerL",class:ct.value},ht()))}return z}return Vt(()=>{document.removeEventListener("mouseup",ge,!0)}),{state:{active:b,focus:v,preventFocus:m,dragging:C,editable:S,classes:nt,tabindex:et,attributes:at,roundValueFn:R,keyStep:W,trackLen:le,innerMin:U,innerMinRatio:re,innerMax:P,innerMaxRatio:me,positionProp:oe,sizeProp:xe,isReversed:N},methods:{onActivate:kt,onMobileClick:St,onBlur:Ve,onKeyup:Ct,getContent:$t,getThumbRenderFn:At,convertRatioToModel:vt,convertModelToRatio:fe,getDraggingRatio:gt}}}const la=()=>({}),ra=_e({name:"QSlider",props:{...ta,modelValue:{required:!0,default:null,validator:a=>typeof a=="number"||a===null},labelValue:[String,Number]},emits:aa,setup(a,{emit:n}){const{proxy:{$q:u}}=Ge(),{state:o,methods:e}=na({updateValue:L,updatePosition:N,getDragging:de,formAttrs:qt(a)}),l=T(null),r=T(0),d=T(0);function Q(){d.value=a.modelValue===null?o.innerMin.value:Y(a.modelValue,o.innerMin.value,o.innerMax.value)}ke(()=>`${a.modelValue}|${o.innerMin.value}|${o.innerMax.value}`,Q),Q();const X=s(()=>e.convertModelToRatio(d.value)),b=s(()=>o.active.value===!0?r.value:X.value),m=s(()=>{const S={[o.positionProp.value]:`${100*o.innerMinRatio.value}%`,[o.sizeProp.value]:`${100*(b.value-o.innerMinRatio.value)}%`};return a.selectionImg!==void 0&&(S.backgroundImage=`url(${a.selectionImg}) !important`),S}),v=e.getThumbRenderFn({focusValue:!0,getNodeData:la,ratio:b,label:s(()=>a.labelValue!==void 0?a.labelValue:d.value),thumbColor:s(()=>a.thumbColor||a.color),labelColor:s(()=>a.labelColor),labelTextColor:s(()=>a.labelTextColor)}),C=s(()=>o.editable.value!==!0?{}:u.platform.is.mobile===!0?{onClick:e.onMobileClick}:{onMousedown:e.onActivate,onFocus:U,onBlur:e.onBlur,onKeydown:P,onKeyup:e.onKeyup});function L(S){d.value!==a.modelValue&&n("update:modelValue",d.value),S===!0&&n("change",d.value)}function de(){return l.value.getBoundingClientRect()}function N(S,R=o.dragging.value){const W=e.getDraggingRatio(S,R);d.value=e.convertRatioToModel(W),r.value=a.snap!==!0||a.step===0?W:e.convertModelToRatio(d.value)}function U(){o.focus.value=!0}function P(S){if(Ze.includes(S.keyCode)===!1)return;Dt(S);const R=([34,33].includes(S.keyCode)?10:1)*o.keyStep.value,W=([34,37,40].includes(S.keyCode)?-1:1)*(o.isReversed.value===!0?-1:1)*(a.vertical===!0?-1:1)*R;d.value=Y(o.roundValueFn.value(d.value+W),o.innerMin.value,o.innerMax.value),L()}return()=>{const S=e.getContent(m,o.tabindex,C,R=>{R.push(v())});return x("div",{ref:l,class:o.classes.value+(a.modelValue===null?" q-slider--no-value":""),...o.attributes.value,"aria-valuenow":a.modelValue},S)}}}),oa={class:"row justify-end"},Re=M({__name:"FleetCargoSyncAction",props:{fleet:{type:B,required:!0},cargoMint:{type:B,required:!0},amount:{type:Number,default:0}},setup(a){const n=a,u=O();async function o(){const e=q(),l=[],r=new K(q());try{n.amount>0&&l.push(...await r.cargoToFleetIx(n.fleet,n.cargoMint,Math.abs(n.amount))),n.amount<0&&l.push(...await r.cargoToStarbaseIx(n.fleet,n.cargoMint,Math.abs(n.amount))),l.length>0&&await j(`Transfer Cargo: ${n.amount>0?"Starbase -> Fleet":"Fleet -> Starbase"}`,l,e,H.DEFAULT_FEE),await p().updateFleet(),await p().updateFleetCargoAccounts(n.fleet)}catch(d){u.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),$("div",oa,[i(I,{color:"secondary",label:"Sync",onClick:G(o,["prevent"])})]))}}),sa={class:"text-grey-5"},ia={key:0,class:"col row"},ua={key:1,class:"col"},ca={class:"row items-center"},da={class:"row items-center"},ma={class:"col"},fa={key:3},va={class:"row q-gutter-x-sm"},ga={class:"col"},pa={class:"row items-center"},ba={class:"col row items-center"},ya={class:"col row items-center"},ze=M({__name:"CargoTable",props:{fleet:{type:B,required:!0},rows:{type:{},required:!0},action:{type:String}},setup(a){const n=a,u=T(),o=T([{style:"width: 10px",name:"extend",required:!0,align:"left",sortable:!1},{name:"symbol",required:!0,label:"Symbol",align:"left",field:b=>b?.symbol,sortable:!0},{name:"name",required:!0,label:"Name",align:"left",field:b=>b?.name,sortable:!0},{name:"uiAmount",required:!0,label:"Quantity",align:"right",field:b=>b.uiAmount,sortable:!0}]),e=s(()=>{const b=p()?.fleetFuelAccount?.uiAmount;return p().fleets?.find(m=>m.key.toString()==n.fleet.toString())?.data.stats.cargoStats.fuelCapacity-(b??0)}),l=s(()=>{const b=p()?.fleetAmmoAccount?.uiAmount;return p().fleets?.find(m=>m.key.toString()==n.fleet.toString())?.data.stats.cargoStats.ammoCapacity-(b??0)}),r=s(()=>{const b=p()?.fleetCargoAccounts?.flatMap(m=>m.uiAmount)?.reduce((m,v)=>m+v,0);return p().fleets?.find(m=>m.key.toString()==n.fleet.toString())?.data.stats.cargoStats.cargoCapacity-(b??0)});function d(b){switch(V().tokenList.find(m=>m.mint.toString()==b.toString())?.symbol){case"FUEL":return p().fleets?.find(m=>m.key.toString()==n.fleet.toString())?.data.stats.cargoStats.fuelCapacity;case"AMMO":return p().fleets?.find(m=>m.key.toString()==n.fleet.toString())?.data.stats.cargoStats.ammoCapacity;default:return p().fleets?.find(m=>m.key.toString()==n.fleet.toString())?.data.stats.cargoStats.cargoCapacity}}function Q(b){switch(V().tokenList.find(m=>m.mint.toString()==b.toString())?.symbol){case"FUEL":return e.value;case"AMMO":return l.value;default:return r.value}}function X(b){switch(V().tokenList.find(m=>m.mint.toString()==b.toString())?.symbol){case"FUEL":return p().fleetFuelAccount?.uiAmount||0;case"AMMO":return p().fleetAmmoAccount?.uiAmount||0;default:return p().fleetCargoAccounts?.find(m=>m.mint.toString()==b.toString())?.uiAmount||0}}return(b,m)=>n.rows?(c(),y(Xe,{key:0,columns:o.value,filter:u.value,pagination:{rowsPerPage:0,sortBy:"name",descending:!0},rows:n.rows,dense:"",flat:"","hide-bottom":"","row-key":"name",square:""},{"top-left":g(()=>[k("div",sa,"Found "+E(a.rows.length)+" Items",1)]),"top-right":g(()=>[i(ue,{modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=v=>u.value=v),borderless:"",debounce:"300",dense:"",placeholder:"Search"},{append:g(()=>[i(Se,{name:"search"})]),_:1},8,["modelValue"])]),body:g(v=>[i(ae,{props:v,onClick:C=>v.expand=!v.expand},{default:g(()=>[(c(!0),$(Z,null,he(v.cols,C=>(c(),y(te,{key:C.name,props:v},{default:g(()=>[C.name=="extend"?(c(),$("div",ia,[i(I,{class:"",color:"primary",icon:"expand"})])):C.name=="uiAmount"?(c(),$("div",ua,[k("div",ca,[m[1]||(m[1]=k("div",{class:"col-1"},"@Starbase",-1)),i(De,{number:_(p)().starbaseTokenAccounts?.find(L=>L.mint.toString()==v.row.mint.toString())?.uiAmount??0,url:v.row.thumbnailUrl,class:"col",decimals:"1","pad-start":"10"},null,8,["number","url"])]),k("div",da,[m[2]||(m[2]=k("div",null,"@Cargo",-1)),k("div",ma,E(((X(v.row.mint)+v.row.uiAmountChange)/d(v.row.mint)*100).toFixed(0))+"% ",1),i(De,{number:X(v.row.mint),url:v.row.thumbnailUrl,class:"col",decimals:"1","pad-start":"10"},null,8,["number","url"])])])):C.name=="action"&&a.action=="sync"?(c(),y(Re,{key:2,"cargo-mint":v.row.mint,fleet:n.fleet,"is-amount":0,"should-amount":0},null,8,["cargo-mint","fleet"])):(c(),$("div",fa,E(C.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick"]),Ke(i(ae,{props:v},{default:g(()=>[i(te,{class:"",colspan:"100%"},{default:g(()=>[k("div",va,[k("div",ga,[k("div",pa,[k("div",ba,[k("div",ya,[m[3]||(m[3]=k("div",{class:"text-subtitle2"},"@Starbase",-1)),i(ra,{modelValue:v.row.uiAmountChange,"onUpdate:modelValue":C=>v.row.uiAmountChange=C,max:Q(v.row.mint),min:-v.row.uiAmount,step:1,class:"col q-mx-md",color:"accent",label:""},null,8,["modelValue","onUpdate:modelValue","max","min"]),m[4]||(m[4]=k("div",{class:"text-subtitle2"},"@Cargo",-1))])])]),i(ue,{modelValue:v.row.uiAmountChange,"onUpdate:modelValue":C=>v.row.uiAmountChange=C,class:"col",dense:"",standout:"",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),i(Re,{amount:v.row.uiAmountChange,"cargo-mint":v.row.mint,fleet:n.fleet},null,8,["amount","cargo-mint","fleet"])])]),_:2},1024)]),_:2},1032,["props"]),[[We,v.expand]])]),_:1},8,["columns","filter","rows"])):A("",!0)}}),ha=M({__name:"FleetCargoDialog",props:{name:{type:String,default:"none"},fleet:{type:B,required:!0}},setup(a){const n=T(!1),u=a;return s(()=>p().fleets.find(o=>o.key==u.fleet)),ke(()=>n.value,async()=>{await p().updateFleetCargoAccounts(u.fleet),p().starbaseTokenAccountsSelected=void 0}),(o,e)=>(c(),$(Z,null,[i(I,{color:"secondary",label:"Edit Cargo",onClick:e[0]||(e[0]=l=>n.value=!0)}),i(je,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),"full-width":"","transition-hide":"rotate","transition-show":"rotate"},{default:g(()=>[i(ce,{bordered:"",flat:""},{default:g(()=>[i(Ye,{text:"Cargo"}),i(ne),i(Ne,{caption:"Consumed Resources","default-opened":"","expand-separator":"",icon:"perm_identity",label:"Fleet Provision"},{default:g(()=>[_(p)().fleetFilteredConsumptionAccounts?(c(),y(ze,{key:0,fleet:u.fleet,rows:_(p)().fleetFilteredConsumptionAccounts,action:"sync",class:"bg-primary"},null,8,["fleet","rows"])):A("",!0)]),_:1}),i(Ne,{caption:"Cargo fleet storage","default-opened":"","expand-separator":"",icon:"perm_identity",label:"Fleet Cargo"},{default:g(()=>[_(p)().fleetFilteredCargoAccounts?(c(),y(ze,{key:0,fleet:u.fleet,rows:_(p)().fleetFilteredCargoAccounts,action:"sync",class:"bg-primary"},null,8,["fleet","rows"])):A("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),wa={class:"row"},_a=M({__name:"FleetDockAction",props:{fleet:{type:B,required:!0}},setup(a){const n=a,u=O();async function o(){const e=q(),l=[],r=new K(q());try{l.push(...await r.fleetDock(n.fleet)),l.length>0&&await j("Instructions Withdraw",l,e,H.DEFAULT_FEE),D().fleets=await J()}catch(d){u.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),$("div",wa,[i(I,{color:"secondary",label:"Dock",onClick:G(o,["prevent"])})]))}}),ka={class:"row"},Sa=M({__name:"FleetUndockAction",props:{fleet:{type:B,required:!0}},setup(a){const n=a,u=O();async function o(){const e=q(),l=[],r=new K(q());try{l.push(...await r.fleetUndock(n.fleet)),l.length>0&&await j("Instructions Withdraw",l,e,H.DEFAULT_FEE),D().fleets=await J()}catch(d){u.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),$("div",ka,[i(I,{color:"secondary",label:"Undock",onClick:G(o,["prevent"])})]))}}),Ca={class:"row"},xa=M({__name:"FleetStartMiningAction",props:{fleet:{type:B,required:!0}},setup(a){const n=a,u=O();async function o(){const e=q(),l=[],r=new K(q());try{l.push(...await r.startMining(n.fleet)),l.length>0&&await j("Instructions start mining",l,e,H.DEFAULT_FEE),D().fleets=await J()}catch(d){u.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),$("div",Ca,[i(I,{color:"secondary",label:"Start mining",onClick:G(o,["prevent"])})]))}}),Aa={class:"row"},$a=M({__name:"FleetStopMiningAction",props:{fleet:{type:B,required:!0}},setup(a){const n=a,u=O();async function o(){const e=q(),l=[],r=new K(q());try{l.push(...await r.asteroidMiningHandler(n.fleet)),l.push(...await r.stopMining(n.fleet)),l.length>0&&await j("Instructions stop mining",l,e,H.DEFAULT_FEE),D().fleets=await J()}catch(d){u.notify({type:"warning",message:"warning",caption:d.toString(),position:"bottom-right"})}}return(e,l)=>(c(),$("div",Aa,[i(I,{color:"secondary",label:"Stop mining",onClick:G(o,["prevent"])})]))}}),Fa={class:"text-grey-5"},Ta={key:0,class:"row q-gutter-x-sm justify-end"},qa={key:1},Ma={class:"text-left"},La=M({__name:"FleetTable",props:{rows:{type:{},required:!0}},setup(a){const n=a,u=T(),o=T([{name:"extend",required:!0,align:"left",sortable:!1},{name:"fleetLabel",required:!0,label:"Fleet name",align:"left",field:e=>ee.byteArrayToString(e.data.fleetLabel),sortable:!0},{name:"state",required:!0,label:"State",align:"left",field:e=>Object.keys(e.state)[0],sortable:!0},{name:"actions",required:!1,label:"Actions",align:"right",sortable:!1}]);return(e,l)=>n.rows?(c(),y(Xe,{key:0,columns:o.value,filter:u.value,pagination:{rowsPerPage:0,sortBy:"name",descending:!0},rows:a.rows,flat:"","hide-bottom":"","row-key":"name",square:""},{"top-left":g(()=>[k("div",Fa,"Found "+E(a.rows.length)+" Items",1)]),"top-right":g(()=>[i(Gt,null,{default:g(()=>[i(ue,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=r=>u.value=r),debounce:"300",dense:"",placeholder:"Search",standout:""},{append:g(()=>[i(Se,{name:"search"})]),_:1},8,["modelValue"]),i(I,{color:"primary",icon:"refresh",square:"",onClick:l[1]||(l[1]=r=>_(p)().updateFleet())})]),_:1})]),header:g(r=>[i(ae,{props:r},{default:g(()=>[i(Ue,{"auto-width":""}),(c(!0),$(Z,null,he(r.cols,d=>(c(),y(Ue,{key:d.name,props:r},{default:g(()=>[Ee(E(d.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:g(r=>[i(ae,{props:r},{default:g(()=>[i(te,{"auto-width":""},{default:g(()=>[i(I,{icon:r.expand?"remove":"add",color:"accent",dense:"",round:"",size:"sm",onClick:d=>r.expand=!r.expand},null,8,["icon","onClick"])]),_:2},1024),(c(!0),$(Z,null,he(r.cols,d=>(c(),y(te,{key:d.name,props:r},{default:g(()=>[d.name=="actions"?(c(),$("div",Ta,[Ee(E()+" ",1),r.row.state.StarbaseLoadingBay?(c(),y(Yt,{key:0,fleet:r.row.key,name:_(ee.byteArrayToString)(r.row.data.fleetLabel)},null,8,["fleet","name"])):A("",!0),r.row.state.StarbaseLoadingBay?(c(),y(ha,{key:1,fleet:r.row.key,name:_(ee.byteArrayToString)(r.row.data.fleetLabel)},null,8,["fleet","name"])):A("",!0),r.row.state.Idle?(c(),y(_a,{key:2,fleet:r.row.key},null,8,["fleet"])):A("",!0),r.row.state.StarbaseLoadingBay?(c(),y(Sa,{key:3,fleet:r.row.key},null,8,["fleet"])):A("",!0),r.row.state.Idle?(c(),y(xa,{key:4,fleet:r.row.key},null,8,["fleet"])):A("",!0),r.row.state.MineAsteroid?(c(),y($a,{key:5,fleet:r.row.key},null,8,["fleet"])):A("",!0)])):(c(),$("div",qa,E(d.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),Ke(i(ae,{props:r},{default:g(()=>[i(te,{colspan:"100%"},{default:g(()=>[l[2]||(l[2]=k("div",null,null,-1)),k("div",Ma,E(JSON.stringify(r.row,null,2))+".",1)]),_:2},1024)]),_:2},1032,["props"]),[[We,r.expand]])]),_:1},8,["columns","filter","rows"])):A("",!0)}}),Ia={key:2},Ka=M({__name:"FleetPage",setup(a){const n=T("manage");return Ut(async()=>{await Qt().updateStore(Nt()),await D().updateStore()}),(u,o)=>_(D)().starbases?.length?(c(),y(Be,{key:1,class:""},{default:g(()=>[i(Ye,{text:"Fleet Manager"}),k("div",null,[i(ne),i(He,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=e=>n.value=e),"active-bg-color":"primary",align:"justify","inline-label":""},{default:g(()=>[i(ie,{label:"Manage",name:"manage"}),i(ie,{label:"Create",name:"create"})]),_:1},8,["modelValue"]),i(ne),!_(p)().fleets?.length&&n.value=="manage"?(c(),y(Qe,{key:0,message:"Fleets found"})):n.value=="manage"?(c(),y(La,{key:1,rows:_(p)().fleets},null,8,["rows"])):A("",!0),n.value=="create"?(c(),$("div",Ia,[i(Mt,{modelValue:_(p)().currentStarbase,"onUpdate:modelValue":o[1]||(o[1]=e=>_(p)().currentStarbase=e),disable:!0,"option-label":e=>_(ee.byteArrayToString)(e.data.name),options:_(D)().starbases?.filter(e=>_(ee.byteArrayToString)(e.data.name).includes("Central")),class:"",label:"Selected Starbase",square:"",standout:""},{prepend:g(()=>[i(Se,{name:"home"})]),_:1},8,["modelValue","option-label","options"]),_(p)().currentStarbase?(c(),y(Ot,{key:1})):(c(),y(Qe,{key:0,message:"Please select a starbase"}))])):A("",!0)])]),_:1})):(c(),y(Be,{key:0,class:"row justify-center items-center"},{default:g(()=>[i(Lt)]),_:1}))}});export{Ka as default};
